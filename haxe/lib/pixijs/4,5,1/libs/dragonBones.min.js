var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function a(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}(),dragonBones;!function(t){var e=function(){function t(){}return t.hasArmature=function(e){return t._armatures.indexOf(e)>=0},t.addArmature=function(e){e&&t._armatures.indexOf(e)<0&&t._armatures.push(e)},t.removeArmature=function(e){if(e){var i=t._armatures.indexOf(e);i>=0&&t._armatures.splice(i,1)}},t}();e.PI_D=2*Math.PI,e.PI_H=Math.PI/2,e.PI_Q=Math.PI/4,e.ANGLE_TO_RADIAN=Math.PI/180,e.RADIAN_TO_ANGLE=180/Math.PI,e.SECOND_TO_MILLISECOND=1e3,e.NO_TWEEN=100,e.VERSION="5.0.0",e.ARGUMENT_ERROR="Argument error.",e.yDown=!0,e.debug=!1,e.debugDraw=!1,e._armatures=[],t.DragonBones=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(){this.hashCode=t._hashCode++}return t._returnObject=function(e){var i=String(e.constructor),a=null==t._maxCountMap[i]?t._defaultMaxCount:t._maxCountMap[i],n=t._poolsMap[i]=t._poolsMap[i]||[];n.length<a&&n.push(e)},t.setMaxCount=function(e,i){if((i<0||i!==i)&&(i=0),e){var a=String(e);t._maxCountMap[a]=i;var n=t._poolsMap[a];n&&n.length>i&&(n.length=i)}else{t._defaultMaxCount=i;for(var a in t._poolsMap)if(null!=t._maxCountMap[a]){t._maxCountMap[a]=i;var n=t._poolsMap[a];n.length>i&&(n.length=i)}}},t.clearPool=function(e){if(void 0===e&&(e=null),e){var i=t._poolsMap[String(e)];i&&i.length&&(i.length=0)}else for(var a in t._poolsMap){var i=t._poolsMap[a];i.length=0}},t.borrowObject=function(e){var i=t._poolsMap[String(e)];if(i&&i.length>0)return i.pop();var a=new e;return a._onClear(),a},t.prototype.returnToPool=function(){this._onClear(),t._returnObject(this)},t}();e._hashCode=0,e._defaultMaxCount=5e3,e._maxCountMap={},e._poolsMap={},t.BaseObject=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y},t.prototype.clear=function(){this.x=this.y=0},t}();t.Point=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,a){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===a&&(a=0),this.x=t,this.y=e,this.width=i,this.height=a}return t.prototype.copyFrom=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},t.prototype.clear=function(){this.x=this.y=0,this.width=this.height=0},t}();t.Rectangle=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(t,e,i,a,n,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===n&&(n=1),void 0===r&&(r=1),this.x=t,this.y=e,this.skewX=i,this.skewY=a,this.scaleX=n,this.scaleY=r}return e.normalizeRadian=function(t){return t=(t+Math.PI)%(2*Math.PI),t+=t>0?-Math.PI:Math.PI},e.prototype.toString=function(){return"[object dragonBones.Transform] x:"+this.x+" y:"+this.y+" skewX:"+180*this.skewX/Math.PI+" skewY:"+180*this.skewY/Math.PI+" scaleX:"+this.scaleX+" scaleY:"+this.scaleY},e.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.skewX=t.skewX,this.skewY=t.skewY,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this},e.prototype.identity=function(){return this.x=this.y=this.skewX=this.skewY=0,this.scaleX=this.scaleY=1,this},e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.skewX+=t.skewX,this.skewY+=t.skewY,this.scaleX*=t.scaleX,this.scaleY*=t.scaleY,this},e.prototype.minus=function(t){return this.x-=t.x,this.y-=t.y,this.skewX=e.normalizeRadian(this.skewX-t.skewX),this.skewY=e.normalizeRadian(this.skewY-t.skewY),this.scaleX/=t.scaleX,this.scaleY/=t.scaleY,this},e.prototype.fromMatrix=function(i){this.x=i.tx,this.y=i.ty,this.skewX=Math.atan(-i.c/i.d),this.skewY=Math.atan(i.b/i.a);var a=this.scaleX,n=this.scaleY,r=t.DragonBones.PI_Q,s=this.skewX-this.skewY,o=Math.cos(this.skewX),h=Math.sin(this.skewX);return-.01<s&&s<.01?this.scaleX=this.skewY>-r&&this.skewY<r?i.a/o:i.b/h:this.scaleX=this.skewY>-r&&this.skewY<r?i.a/Math.cos(this.skewY):i.b/Math.sin(this.skewY),this.scaleY=this.skewX>-r&&this.skewX<r?i.d/o:-i.c/h,a>=0&&this.scaleX<0&&(this.scaleX=-this.scaleX,this.skewY=e.normalizeRadian(this.skewY-Math.PI)),n>=0&&this.scaleY<0&&(this.scaleY=-this.scaleY,this.skewX=e.normalizeRadian(this.skewX-Math.PI)),this},e.prototype.toMatrix=function(t){if(0!==this.skewX||0!==this.skewY){t.a=Math.cos(this.skewY),t.b=Math.sin(this.skewY);var e=this.skewX-this.skewY;-.01<e&&e<.01?(t.c=-t.b,t.d=t.a):(t.c=-Math.sin(this.skewX),t.d=Math.cos(this.skewX)),1!==this.scaleX&&(t.a*=this.scaleX,t.b*=this.scaleX),1!==this.scaleY&&(t.c*=this.scaleY,t.d*=this.scaleY)}else t.a=this.scaleX,t.b=0,t.c=0,t.d=this.scaleY;return t.tx=this.x,t.ty=this.y,this},Object.defineProperty(e.prototype,"rotation",{get:function(){return this.scaleX>=0?this.skewY:this.skewY+Math.PI},set:function(t){var e=this.scaleX>=0?t-this.skewY:t-this.skewY-Math.PI;this.skewX+=e,this.skewY+=e},enumerable:!0,configurable:!0}),e}();t.Transform=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,a,n,r){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===a&&(a=1),void 0===n&&(n=0),void 0===r&&(r=0),this.a=t,this.b=e,this.c=i,this.d=a,this.tx=n,this.ty=r}return t.prototype.toString=function(){return"[object dragonBones.Matrix] a:"+this.a+" b:"+this.b+" c:"+this.c+" d:"+this.d+" tx:"+this.tx+" ty:"+this.ty},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},t.prototype.copyFromArray=function(t,e){return void 0===e&&(e=0),this.a=t[e],this.b=t[e+1],this.c=t[e+2],this.d=t[e+3],this.tx=t[e+4],this.ty=t[e+5],this},t.prototype.identity=function(){return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this},t.prototype.concat=function(t){var e=this.a*t.a,i=0,a=0,n=this.d*t.d,r=this.tx*t.a+t.tx,s=this.ty*t.d+t.ty;return 0===this.b&&0===this.c||(e+=this.b*t.c,i+=this.b*t.d,a+=this.c*t.a,n+=this.c*t.b),0===t.b&&0===t.c||(i+=this.a*t.b,a+=this.d*t.c,r+=this.ty*t.c,s+=this.tx*t.b),this.a=e,this.b=i,this.c=a,this.d=n,this.tx=r,this.ty=s,this},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,a=this.d,n=this.tx,r=this.ty;if(0===e&&0===i)return this.b=this.c=0,0===t||0===a?this.a=this.b=this.tx=this.ty=0:(t=this.a=1/t,a=this.d=1/a,this.tx=-t*n,this.ty=-a*r),this;var s=t*a-e*i;if(0===s)return this.a=this.d=1,this.b=this.c=0,this.tx=this.ty=0,this;s=1/s;var o=this.a=a*s;return e=this.b=-e*s,i=this.c=-i*s,a=this.d=t*s,this.tx=-(o*n+i*r),this.ty=-(e*n+a*r),this},t.prototype.transformPoint=function(t,e,i,a){void 0===a&&(a=!1),i.x=this.a*t+this.c*e,i.y=this.b*t+this.d*e,a||(i.x+=this.tx,i.y+=this.ty)},t}();t.Matrix=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function t(t,e,i,a,n,r,s,o){void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i=1),void 0===a&&(a=1),void 0===n&&(n=0),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=0),this.alphaMultiplier=t,this.redMultiplier=e,this.greenMultiplier=i,this.blueMultiplier=a,this.alphaOffset=n,this.redOffset=r,this.greenOffset=s,this.blueOffset=o}return t.prototype.copyFrom=function(t){this.alphaMultiplier=t.alphaMultiplier,this.redMultiplier=t.redMultiplier,this.greenMultiplier=t.greenMultiplier,this.blueMultiplier=t.blueMultiplier,this.alphaOffset=t.alphaOffset,this.redOffset=t.redOffset,this.redOffset=t.redOffset,this.greenOffset=t.blueOffset},t.prototype.identity=function(){this.alphaMultiplier=this.redMultiplier=this.greenMultiplier=this.blueMultiplier=1,this.alphaOffset=this.redOffset=this.greenOffset=this.blueOffset=0},t}();t.ColorTransform=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.boneMask=[],e.animationNames=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.AnimationConfig]"},e.prototype._onClear=function(){this.pauseFadeOut=!0,this.fadeOutMode=4,this.fadeOutTime=-1,this.fadeOutEasing=0,this.additiveBlending=!1,this.displayControl=!0,this.pauseFadeIn=!0,this.actionEnabled=!0,this.playTimes=-1,this.layer=0,this.position=0,this.duration=-1,this.timeScale=-100,this.fadeInTime=-1,this.autoFadeOutTime=-1,this.fadeInEasing=0,this.weight=1,this.name=null,this.animationName=null,this.group=null,this.boneMask.length=0,this.animationNames.length=0},e.prototype.clear=function(){this._onClear()},e.prototype.copyFrom=function(t){this.pauseFadeOut=t.pauseFadeOut,this.fadeOutMode=t.fadeOutMode,this.autoFadeOutTime=t.autoFadeOutTime,this.fadeOutEasing=t.fadeOutEasing,this.additiveBlending=t.additiveBlending,this.displayControl=t.displayControl,this.pauseFadeIn=t.pauseFadeIn,this.actionEnabled=t.actionEnabled,this.playTimes=t.playTimes,this.layer=t.layer,this.position=t.position,this.duration=t.duration,this.timeScale=t.timeScale,this.fadeInTime=t.fadeInTime,this.fadeOutTime=t.fadeOutTime,this.fadeInEasing=t.fadeInEasing,this.weight=t.weight,this.name=t.name,this.animationName=t.animationName,this.group=t.group,this.boneMask.length=t.boneMask.length;for(var e=0,i=this.boneMask.length;e<i;++e)this.boneMask[e]=t.boneMask[e];this.animationNames.length=t.animationNames.length;for(var e=0,i=this.animationNames.length;e<i;++e)this.animationNames[e]=t.animationNames[e]},e.prototype.containsBoneMask=function(t){return 0===this.boneMask.length||this.boneMask.indexOf(t)>=0},e.prototype.addBoneMask=function(t,e,i){void 0===i&&(i=!0);var a=t.getBone(e);if(a&&(this.boneMask.indexOf(e)<0&&this.boneMask.push(e),i))for(var n=t.getBones(),r=0,s=n.length;r<s;++r){var o=n[r];this.boneMask.indexOf(o.name)<0&&a.contains(o)&&this.boneMask.push(o.name)}},e.prototype.removeBoneMask=function(t,e,i){void 0===i&&(i=!0);var a=this.boneMask.indexOf(e);if(a>=0&&this.boneMask.splice(a,1),i){var n=t.getBone(e);if(n){var r=t.getBones();if(this.boneMask.length>0)for(var s=0,o=r.length;s<o;++s){var h=r[s],l=this.boneMask.indexOf(h.name);l>=0&&n.contains(h)&&this.boneMask.splice(l,1)}else for(var s=0,o=r.length;s<o;++s){var h=r[s];n.contains(h)||this.boneMask.push(h.name)}}}},e}(t.BaseObject);t.AnimationConfig=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._onClear=function(){this.position=0,this.duration=0,this.prev=null,this.next=null},e}(t.BaseObject);t.FrameData=e;var i=function(e){function i(){return e.call(this)||this}return __extends(i,e),i._getCurvePoint=function(t,e,i,a,n,r,s,o,h,l){var _=1-h,u=_*_,m=h*h,f=_*u,c=3*h*u,p=3*_*m,d=h*m;l.x=f*t+c*i+p*n+d*s,l.y=f*e+c*a+p*r+d*o},i.samplingEasingCurve=function(e,a){for(var n=e.length,r=new t.Point,s=-2,o=0,h=a.length;o<h;++o){for(var l=(o+1)/(h+1);(s+6<n?e[s+6]:1)<l;)s+=6;for(var _=s>=0&&s+6<n,u=_?e[s]:0,m=_?e[s+1]:0,f=e[s+2],c=e[s+3],p=e[s+4],d=e[s+5],g=_?e[s+6]:1,y=_?e[s+7]:1,b=0,T=1;T-b>.01;){var v=(T+b)/2;i._getCurvePoint(u,m,f,c,p,d,g,y,v,r),l-r.x>0?b=v:T=v}a[o]=r.y}},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.tweenEasing=0,this.curve=null},i}(e);t.TweenFrameData=i;var a=function(t){function e(){var e=t.call(this)||this;return e.actions=[],e.events=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.AnimationFrameData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this);for(var e=0,i=this.actions.length;e<i;++e)this.actions[e].returnToPool();for(var e=0,i=this.events.length;e<i;++e)this.events[e].returnToPool();this.actions.length=0,this.events.length=0},e}(e);t.AnimationFrameData=a;var n=function(t){function e(){var e=t.call(this)||this;return e.zOrder=[],e}return __extends(e,t),e.prototype._onClear=function(){t.prototype._onClear.call(this),this.zOrder.length=0},e}(e);t.ZOrderFrameData=n;var r=function(e){function i(){var i=e.call(this)||this;return i.transform=new t.Transform,i}return __extends(i,e),i.toString=function(){return"[class dragonBones.BoneFrameData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.tweenScale=!1,this.tweenRotate=0,this.transform.identity()},i}(i);t.BoneFrameData=r;var s=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.generateColor=function(){return new t.ColorTransform},i.toString=function(){return"[class dragonBones.SlotFrameData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.displayIndex=0,this.color=null},i}(i);s.DEFAULT_COLOR=new t.ColorTransform,t.SlotFrameData=s;var o=function(t){function e(){var e=t.call(this)||this;return e.tweens=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.ExtensionFrameData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.tweens.length=0},e}(i);t.ExtensionFrameData=o}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.frames=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.TimelineData]"},e.prototype._onClear=function(){for(var t=null,e=0,i=this.frames.length;e<i;++e){var a=this.frames[e];t&&a!==t&&t.returnToPool(),t=a}this.scale=1,this.offset=0,this.frames.length=0},e}(t.BaseObject);t.TimelineData=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.ZOrderTimelineData]"},e}(e);t.ZOrderTimelineData=i;var a=function(e){function i(){var i=e.call(this)||this;return i.originalTransform=new t.Transform,i}return __extends(i,e),i.toString=function(){return"[class dragonBones.BoneTimelineData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.originalTransform.identity(),this.bone=null},i}(e);t.BoneTimelineData=a;var n=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.SlotTimelineData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.slot=null},e}(e);t.SlotTimelineData=n;var r=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.FFDTimelineData]"},e.prototype._onClear=function(){t.prototype._onClear.call(this),this.skin=null,this.slot=null,this.display=null},e}(e);t.FFDTimelineData=r}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.boneTimelines={},t.slotTimelines={},t.ffdTimelines={},t.cachedFrames=[],t.boneCachedFrameIndices={},t.slotCachedFrameIndices={},t}return __extends(i,e),i.toString=function(){return"[class dragonBones.AnimationData]"},i.prototype._onClear=function(){e.prototype._onClear.call(this);for(var t in this.boneTimelines)this.boneTimelines[t].returnToPool(),delete this.boneTimelines[t];for(var t in this.slotTimelines)this.slotTimelines[t].returnToPool(),delete this.slotTimelines[t];for(var t in this.ffdTimelines){for(var i in this.ffdTimelines[t])for(var a in this.ffdTimelines[t][i])this.ffdTimelines[t][i][a].returnToPool();delete this.ffdTimelines[t]}for(var t in this.boneCachedFrameIndices)delete this.boneCachedFrameIndices[t];for(var t in this.slotCachedFrameIndices)delete this.slotCachedFrameIndices[t];this.zOrderTimeline&&this.zOrderTimeline.returnToPool(),this.frameCount=0,this.playTimes=0,this.duration=0,this.fadeInTime=0,this.cacheFrameRate=0,this.name=null,this.cachedFrames.length=0,this.zOrderTimeline=null},i.prototype.cacheFrames=function(t){if(!(this.cacheFrameRate>0)){this.cacheFrameRate=Math.max(Math.ceil(t*this.scale),1);var e=Math.ceil(this.cacheFrameRate*this.duration)+1;this.cachedFrames.length=0,this.cachedFrames.length=e;for(var i in this.boneTimelines){for(var a=new Array(e),n=0,r=a.length;n<r;++n)a[n]=-1;this.boneCachedFrameIndices[i]=a}for(var i in this.slotTimelines){for(var a=new Array(e),n=0,r=a.length;n<r;++n)a[n]=-1;this.slotCachedFrameIndices[i]=a}}},i.prototype.addBoneTimeline=function(e){if(!e||!e.bone||this.boneTimelines[e.bone.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.boneTimelines[e.bone.name]=e},i.prototype.addSlotTimeline=function(e){if(!e||!e.slot||this.slotTimelines[e.slot.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.slotTimelines[e.slot.name]=e},i.prototype.addFFDTimeline=function(e){if(!(e&&e.skin&&e.slot&&e.display))throw new Error(t.DragonBones.ARGUMENT_ERROR);var i=this.ffdTimelines[e.skin.name]=this.ffdTimelines[e.skin.name]||{},a=i[e.slot.slot.name]=i[e.slot.slot.name]||{};if(a[e.display.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);a[e.display.name]=e},i.prototype.getBoneTimeline=function(t){return this.boneTimelines[t]},i.prototype.getSlotTimeline=function(t){return this.slotTimelines[t]},i.prototype.getFFDTimeline=function(t,e){var i=this.ffdTimelines[t];return i?i[e]:null},i.prototype.getBoneCachedFrameIndices=function(t){return this.boneCachedFrameIndices[t]},i.prototype.getSlotCachedFrameIndices=function(t){return this.slotCachedFrameIndices[t]},i}(t.TimelineData);t.AnimationData=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.aabb=new t.Rectangle,i.bones={},i.slots={},i.skins={},i.animations={},i.actions=[],i._animationNames=[],i._sortedBones=[],i._sortedSlots=[],i._bonesChildren={},i}return __extends(i,e),i.toString=function(){return"[class dragonBones.ArmatureData]"},i._onSortSlots=function(t,e){return t.zOrder>e.zOrder?1:-1},i.prototype._onClear=function(){for(var t in this.bones)this.bones[t].returnToPool(),delete this.bones[t];for(var t in this.slots)this.slots[t].returnToPool(),delete this.slots[t];for(var t in this.skins)this.skins[t].returnToPool(),delete this.skins[t];for(var t in this.animations)this.animations[t].returnToPool(),delete this.animations[t];for(var e=0,i=this.actions.length;e<i;++e)this.actions[e].returnToPool();for(var t in this._bonesChildren)delete this._bonesChildren[t];this.userData&&this.userData.returnToPool(),this.isRightTransform=!1,this.frameRate=0,this.type=-1,this.cacheFrameRate=0,this.scale=1,this.name=null,this.aabb.clear(),this.actions.length=0,this.parent=null,this.userData=null,this._boneDirty=!1,this._slotDirty=!1,this._animationNames.length=0,this._sortedBones.length=0,this._sortedSlots.length=0,this._defaultSkin=null,this._defaultAnimation=null},i.prototype._sortBones=function(){var t=this._sortedBones.length;if(!(t<1)){var e=this._sortedBones.concat(),i=0,a=0;for(this._sortedBones.length=0;a<t;){var n=e[i++];i>=t&&(i=0),this._sortedBones.indexOf(n)>=0||n.parent&&this._sortedBones.indexOf(n.parent)<0||n.ik&&this._sortedBones.indexOf(n.ik)<0||(n.ik&&n.chain>0&&n.chainIndex===n.chain?this._sortedBones.splice(this._sortedBones.indexOf(n.parent)+1,0,n):this._sortedBones.push(n),a++)}}},i.prototype._sortSlots=function(){this._sortedSlots.sort(i._onSortSlots)},i.prototype.cacheFrames=function(t){if(!(this.cacheFrameRate>0)){this.cacheFrameRate=t;for(var e in this.animations)this.animations[e].cacheFrames(this.cacheFrameRate)}},i.prototype.setCacheFrame=function(t,e,i){void 0===i&&(i=-1);var a=this.parent.cachedFrames;return i<0&&(i=a.length),a.length+=10,a[i]=t.a,a[i+1]=t.b,a[i+2]=t.c,a[i+3]=t.d,a[i+4]=t.tx,a[i+5]=t.ty,a[i+6]=e.skewX,a[i+7]=e.skewY,a[i+8]=e.scaleX,a[i+9]=e.scaleY,i},i.prototype.getCacheFrame=function(t,e,i){var a=this.parent.cachedFrames;t.a=a[i],t.b=a[i+1],t.c=a[i+2],t.d=a[i+3],t.tx=a[i+4],t.ty=a[i+5],e.skewX=a[i+6],e.skewY=a[i+7],e.scaleX=a[i+8],e.scaleY=a[i+9],e.x=t.tx,e.y=t.ty},i.prototype.addBone=function(e,i){if(!e||!e.name||this.bones[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);if(i){var a=this.getBone(i);a?e.parent=a:(this._bonesChildren[i]=this._bonesChildren[i]||[]).push(e)}var n=this._bonesChildren[e.name];if(n){for(var r=0,s=n.length;r<s;++r)n[r].parent=e;delete this._bonesChildren[e.name]}this.bones[e.name]=e,this._sortedBones.push(e),this._boneDirty=!0},i.prototype.addSlot=function(e){if(!e||!e.name||this.slots[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.slots[e.name]=e,this._sortedSlots.push(e),this._slotDirty=!0},i.prototype.addSkin=function(e){if(!e||!e.name||this.skins[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.skins[e.name]=e,this._defaultSkin||(this._defaultSkin=e)},i.prototype.addAnimation=function(e){if(!e||!e.name||this.animations[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.animations[e.name]=e,this._animationNames.push(e.name),this._defaultAnimation||(this._defaultAnimation=e)},i.prototype.getBone=function(t){return this.bones[t]},i.prototype.getSlot=function(t){return this.slots[t]},i.prototype.getSkin=function(t){return t?this.skins[t]:this._defaultSkin},i.prototype.getAnimation=function(t){return t?this.animations[t]:this._defaultAnimation},Object.defineProperty(i.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sortedBones",{get:function(){return this._boneDirty&&(this._boneDirty=!1,this._sortBones()),this._sortedBones},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sortedSlots",{get:function(){return this._slotDirty&&(this._slotDirty=!1,this._sortSlots()),this._sortedSlots},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"defaultSkin",{get:function(){return this._defaultSkin},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"defaultAnimation",{get:function(){return this._defaultAnimation},enumerable:!0,configurable:!0}),i}(t.BaseObject);t.ArmatureData=e;var i=function(e){function i(){var i=e.call(this)||this;return i.transform=new t.Transform,i}return __extends(i,e),i.toString=function(){return"[class dragonBones.BoneData]"},i.prototype._onClear=function(){this.userData&&this.userData.returnToPool(),this.inheritTranslation=!1,this.inheritRotation=!1,this.inheritScale=!1,this.inheritReflection=!1,this.bendPositive=!1,this.chain=0,this.chainIndex=0,this.weight=0,this.length=0,this.name=null,this.transform.identity(),this.parent=null,this.ik=null,this.userData=null},i}(t.BaseObject);t.BoneData=i;var a=function(e){function i(){var t=e.call(this)||this;return t.actions=[],t}return __extends(i,e),i.generateColor=function(){return new t.ColorTransform},i.toString=function(){return"[class dragonBones.SlotData]"},i.prototype._onClear=function(){for(var t=0,e=this.actions.length;t<e;++t)this.actions[t].returnToPool();this.userData&&this.userData.returnToPool(),this.displayIndex=-1,this.zOrder=0,this.blendMode=-1,this.name=null,this.actions.length=0,this.parent=null,this.color=null,this.userData=null},i}(t.BaseObject);a.DEFAULT_COLOR=new t.ColorTransform,t.SlotData=a;var n=function(e){function i(){var t=e.call(this)||this;return t.slots={},t}return __extends(i,e),i.toString=function(){return"[class dragonBones.SkinData]"},i.prototype._onClear=function(){for(var t in this.slots)this.slots[t].returnToPool(),delete this.slots[t];this.name=null},i.prototype.addSlot=function(e){if(!e||!e.slot||this.slots[e.slot.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.slots[e.slot.name]=e},i.prototype.getSlot=function(t){return this.slots[t]},i}(t.BaseObject);t.SkinData=n;var r=function(e){function i(){var t=e.call(this)||this;return t.displays=[],t.meshs={},t}return __extends(i,e),i.toString=function(){return"[class dragonBones.SkinSlotData]"},i.prototype._onClear=function(){for(var t=0,e=this.displays.length;t<e;++t)this.displays[t].returnToPool();for(var i in this.meshs)this.meshs[i].returnToPool(),delete this.meshs[i];this.displays.length=0,this.slot=null},i.prototype.getDisplay=function(t){for(var e=0,i=this.displays.length;e<i;++e){var a=this.displays[e];if(a.name===t)return a}return null},i.prototype.addMesh=function(e){if(!e||!e.name||this.meshs[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.meshs[e.name]=e},i.prototype.getMesh=function(t){return this.meshs[t]},i}(t.BaseObject);t.SkinSlotData=r;var s=function(e){function i(){var i=e.call(this)||this;return i.pivot=new t.Point,i.transform=new t.Transform,i}return __extends(i,e),i.toString=function(){return"[class dragonBones.DisplayData]"},i.prototype._onClear=function(){this.boundingBox&&this.boundingBox.returnToPool(),this.isRelativePivot=!1,this.type=-1,this.inheritAnimation=!0,this.name=null,this.path=null,this.share=null,this.pivot.clear(),this.transform.identity(),this.texture=null,this.armature=null,this.mesh=null,this.boundingBox=null},i}(t.BaseObject);t.DisplayData=s;var o=function(e){function i(){var i=e.call(this)||this;return i.slotPose=new t.Matrix,i.uvs=[],i.vertices=[],i.vertexIndices=[],i.boneIndices=[],i.weights=[],i.boneVertices=[],i.bones=[],i.inverseBindPose=[],i}return __extends(i,e),i.toString=function(){return"[class dragonBones.MeshData]"},i.prototype._onClear=function(){this.skinned=!1,this.name=null,this.slotPose.identity(),this.uvs.length=0,this.vertices.length=0,this.vertexIndices.length=0,this.boneIndices.length=0,this.weights.length=0,this.boneVertices.length=0,this.bones.length=0,this.inverseBindPose.length=0},i}(t.BaseObject);t.MeshData=o;var h=function(t){function e(){var e=t.call(this)||this;return e.vertices=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.BoundingBoxData]"},e._computeOutCode=function(t,e,i,a,n,r){var s=0;return t<i?s|=1:t>n&&(s|=2),e<a?s|=4:e>r&&(s|=8),s},e.segmentIntersectsRectangle=function(t,i,a,n,r,s,o,h,l,_,u){void 0===l&&(l=null),void 0===_&&(_=null),void 0===u&&(u=null);var m=t>r&&t<o&&i>s&&i<h,f=a>r&&a<o&&n>s&&n<h;if(m&&f)return-1;for(var c=0,p=e._computeOutCode(t,i,r,s,o,h),d=e._computeOutCode(a,n,r,s,o,h);;){if(!(p|d)){c=2;break}if(p&d)break;var g=0,y=0,b=0,T=p?p:d;4&T?(g=t+(a-t)*(s-i)/(n-i),y=s,u&&(b=.5*-Math.PI)):8&T?(g=t+(a-t)*(h-i)/(n-i),y=h,u&&(b=.5*Math.PI)):2&T?(y=i+(n-i)*(o-t)/(a-t),g=o,u&&(b=0)):1&T&&(y=i+(n-i)*(r-t)/(a-t),g=r,u&&(b=Math.PI)),T===p?(t=g,i=y,p=e._computeOutCode(t,i,r,s,o,h),u&&(u.x=b)):(a=g,n=y,d=e._computeOutCode(a,n,r,s,o,h),u&&(u.y=b))}return c&&(m?(c=2,l&&(l.x=a,l.y=n),_&&(_.x=a,_.y=a),u&&(u.x=u.y+Math.PI)):f?(c=1,l&&(l.x=t,l.y=i),_&&(_.x=t,_.y=i),u&&(u.y=u.x+Math.PI)):(c=3,l&&(l.x=t,l.y=i),_&&(_.x=a,_.y=n))),c},e.segmentIntersectsEllipse=function(t,e,i,a,n,r,s,o,h,l,_){void 0===h&&(h=null),void 0===l&&(l=null),void 0===_&&(_=null);var u=s/o,m=u*u;e*=u,a*=u;var f=i-t,c=a-e,p=Math.sqrt(f*f+c*c),d=f/p,g=c/p,y=(n-t)*d+(r-e)*g,b=y*y,T=t*t+e*e,v=s*s,D=v-T+b,O=0;if(D>=0){var S=Math.sqrt(D),x=y-S,E=y+S,A=x<0?-1:x<=p?0:1,M=E<0?-1:E<=p?0:1,w=A*M;if(w<0)return-1;0===w&&(A===-1?(O=2,i=t+E*d,a=(e+E*g)/u,h&&(h.x=i,h.y=a),l&&(l.x=i,l.y=a),_&&(_.x=Math.atan2(a/v*m,i/v),_.y=_.x+Math.PI)):1===M?(O=1,t+=x*d,e=(e+x*g)/u,h&&(h.x=t,h.y=e),l&&(l.x=t,l.y=e),_&&(_.x=Math.atan2(e/v*m,t/v),_.y=_.x+Math.PI)):(O=3,h&&(h.x=t+x*d,h.y=(e+x*g)/u,_&&(_.x=Math.atan2(h.y/v*m,h.x/v))),l&&(l.x=t+E*d,l.y=(e+E*g)/u,_&&(_.y=Math.atan2(l.y/v*m,l.x/v)))))}return O},e.segmentIntersectsPolygon=function(t,e,i,a,n,r,s,o){void 0===r&&(r=null),void 0===s&&(s=null),void 0===o&&(o=null),t===i&&(t=i+.01),e===a&&(e=a+.01);for(var h=n.length,l=t-i,_=e-a,u=t*a-e*i,m=0,f=n[h-2],c=n[h-1],p=0,d=0,g=0,y=0,b=0,T=0,v=0;v<h;v+=2){var D=n[v],O=n[v+1];f===D&&(f=D+.01),c===O&&(c=O+.01);var S=f-D,x=c-O,E=f*O-c*D,A=l*x-_*S,M=(u*S-l*E)/A;if((M>=f&&M<=D||M>=D&&M<=f)&&(0===l||M>=t&&M<=i||M>=i&&M<=t)){var w=(u*x-_*E)/A;if((w>=c&&w<=O||w>=O&&w<=c)&&(0===_||w>=e&&w<=a||w>=a&&w<=e)){if(!s){g=M,y=w,b=M,T=w,m++,o&&(o.x=Math.atan2(O-c,D-f)-.5*Math.PI,o.y=o.x);break}var B=M-t;B<0&&(B=-B),0===m?(p=B,d=B,g=M,y=w,b=M,T=w,o&&(o.x=Math.atan2(O-c,D-f)-.5*Math.PI,o.y=o.x)):(B<p&&(p=B,g=M,y=w,o&&(o.x=Math.atan2(O-c,D-f)-.5*Math.PI)),B>d&&(d=B,b=M,T=w,o&&(o.y=Math.atan2(O-c,D-f)-.5*Math.PI))),m++}}f=D,c=O}return 1===m?(r&&(r.x=g,r.y=y),s&&(s.x=g,s.y=y),o&&(o.y=o.x+Math.PI)):m>1&&(m++,r&&(r.x=g,r.y=y),s&&(s.x=b,s.y=T)),m},e.prototype._onClear=function(){this.type=-1,this.color=0,this.x=0,this.y=0,this.width=0,this.height=0,this.vertices.length=0},e.prototype.containsPoint=function(t,e){var i=!1;if(2===this.type){if(t>=this.x&&t<=this.width&&e>=this.y&&e<=this.height)for(var a=0,n=this.vertices.length,r=n-2;a<n;a+=2){var s=this.vertices[r+1],o=this.vertices[a+1];if(o<e&&s>=e||s<e&&o>=e){var h=this.vertices[r],l=this.vertices[a];(e-o)*(h-l)/(s-o)+l<t&&(i=!i)}r=a}}else{var _=.5*this.width;if(t>=-_&&t<=_){var u=.5*this.height;e>=-u&&e<=u&&(1===this.type?(e*=_/u,i=Math.sqrt(t*t+e*e)<=_):i=!0)}}return i},e.prototype.intersectsSegment=function(t,i,a,n,r,s,o){void 0===r&&(r=null),void 0===s&&(s=null),void 0===o&&(o=null);var h=0;switch(this.type){case 0:var l=.5*this.width,_=.5*this.height;h=e.segmentIntersectsRectangle(t,i,a,n,-l,-_,l,_,r,s,o);break;case 1:h=e.segmentIntersectsEllipse(t,i,a,n,0,0,.5*this.width,.5*this.height,r,s,o);break;case 2:0!==e.segmentIntersectsRectangle(t,i,a,n,this.x,this.y,this.width,this.height,null,null)&&(h=e.segmentIntersectsPolygon(t,i,a,n,this.vertices,r,s,o))}return h},e}(t.BaseObject);t.BoundingBoxData=h}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){var e=t.call(this)||this;return e.ints=[],e.floats=[],e.strings=[],e}return __extends(e,t),e.toString=function(){return"[class dragonBones.CustomData]"},e.prototype._onClear=function(){this.ints.length=0,this.floats.length=0,this.strings.length=0},e.prototype.getInt=function(t){return void 0===t&&(t=0),t>=0&&t<this.ints.length?this.ints[t]:0},e.prototype.getFloat=function(t){return void 0===t&&(t=0),t>=0&&t<this.floats.length?this.floats[t]:0},e.prototype.getString=function(t){return void 0===t&&(t=0),t>=0&&t<this.strings.length?this.strings[t]:null},e}(t.BaseObject);t.CustomData=e;var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.EventData]"},e.prototype._onClear=function(){this.data&&this.data.returnToPool(),this.type=-1,this.name=null,this.bone=null,this.slot=null,this.data=null},e}(t.BaseObject);t.EventData=i;var a=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.ActionData]"},e.prototype._onClear=function(){this.animationConfig&&this.animationConfig.returnToPool(),this.type=-1,this.bone=null,this.slot=null,this.animationConfig=null},e}(t.BaseObject);t.ActionData=a;var n=function(e){function i(){var t=e.call(this)||this;return t.armatures={},t.cachedFrames=[],t._armatureNames=[],t}return __extends(i,e),i.toString=function(){return"[class dragonBones.DragonBonesData]"},i.prototype._onClear=function(){if(t.DragonBones.debug)for(var e=0,i=t.DragonBones._armatures.length;e<i;++e){var a=t.DragonBones._armatures[e];if(a.armatureData.parent===this)throw new Error("The DragonBonesData is being used, please make sure all armature references to the data have been deleted.")}for(var n in this.armatures)this.armatures[n].returnToPool(),delete this.armatures[n];this.userData&&this.userData.returnToPool(),this.autoSearch=!1,this.frameRate=0,this.version=null,this.name=null,this.cachedFrames.length=0,this.userData=null,this._armatureNames.length=0},i.prototype.addArmature=function(e){if(!e||!e.name||this.armatures[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.armatures[e.name]=e,this._armatureNames.push(e.name),e.parent=this},i.prototype.getArmature=function(t){return this.armatures[t]},Object.defineProperty(i.prototype,"armatureNames",{get:function(){return this._armatureNames},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this.returnToPool()},i}(t.BaseObject);t.DragonBonesData=n}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t.textures={},t}return __extends(i,e),i.prototype._onClear=function(){for(var t in this.textures)this.textures[t].returnToPool(),delete this.textures[t];this.autoSearch=!1,this.scale=1,this.width=0,this.height=0,this.name=null,
this.imagePath=null},i.prototype.addTexture=function(e){if(!e||!e.name||this.textures[e.name])throw new Error(t.DragonBones.ARGUMENT_ERROR);this.textures[e.name]=e,e.parent=this},i.prototype.getTexture=function(t){return this.textures[t]},i.prototype.copyFrom=function(t){this.autoSearch=t.autoSearch,this.scale=t.scale,this.width=t.width,this.height=t.height,this.name=t.name,this.imagePath=t.imagePath;for(var e in this.textures)this.textures[e].returnToPool(),delete this.textures[e];for(var e in t.textures){var i=this.generateTexture();i.copyFrom(t.textures[e]),this.textures[e]=i}},i}(t.BaseObject);t.TextureAtlasData=e;var i=function(e){function i(){var i=e.call(this)||this;return i.region=new t.Rectangle,i}return __extends(i,e),i.generateRectangle=function(){return new t.Rectangle},i.prototype._onClear=function(){this.rotated=!1,this.name=null,this.region.clear(),this.frame=null,this.parent=null},i.prototype.copyFrom=function(t){this.rotated=t.rotated,this.name=t.name,!this.frame&&t.frame?this.frame=i.generateRectangle():this.frame&&!t.frame&&(this.frame=null),this.frame&&t.frame&&this.frame.copyFrom(t.frame),this.parent=t.parent,this.region.copyFrom(t.region)},i}(t.BaseObject);t.TextureData=i}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this._isOldData=!1,this._isGlobalTransform=!1,this._isAutoTween=!1,this._animationTweenEasing=0,this._timelinePivot=new t.Point,this._helpPoint=new t.Point,this._helpTransformA=new t.Transform,this._helpTransformB=new t.Transform,this._helpMatrix=new t.Matrix,this._rawBones=[],this._data=null,this._armature=null,this._skin=null,this._skinSlotData=null,this._animation=null,this._timeline=null}return e._getArmatureType=function(t){switch(t.toLowerCase()){case"stage":return 2;case"armature":return 0;case"movieclip":return 1;default:return-1}},e._getDisplayType=function(t){switch(t.toLowerCase()){case"image":return 0;case"mesh":return 2;case"armature":return 1;case"boundingbox":return 3;default:return-1}},e._getBoundingBoxType=function(t){switch(t.toLowerCase()){case"rectangle":return 0;case"ellipse":return 1;case"polygon":return 2;default:return-1}},e._getBlendMode=function(t){switch(t.toLowerCase()){case"normal":return 0;case"add":return 1;case"alpha":return 2;case"darken":return 3;case"difference":return 4;case"erase":return 5;case"hardlight":return 6;case"invert":return 7;case"layer":return 8;case"lighten":return 9;case"multiply":return 10;case"overlay":return 11;case"screen":return 12;case"subtract":return 13;default:return-1}},e._getActionType=function(t){switch(t.toLowerCase()){case"play":case"gotoandplay":return 0;default:return-1}},e.prototype._getTimelineFrameMatrix=function(e,i,a,n){var r=Math.floor(a*e.frameCount/e.duration);if(1===i.frames.length||r>=i.frames.length)n.copyFrom(i.frames[0].transform);else{var s=i.frames[r],o=0;s.tweenEasing!==t.DragonBones.NO_TWEEN?(o=(a-s.position)/s.duration,0!==s.tweenEasing&&(o=t.TweenTimelineState._getEasingValue(o,s.tweenEasing))):s.curve&&(o=(a-s.position)/s.duration,o=t.TweenTimelineState._getEasingCurveValue(o,s.curve));var h=s.next;n.x=h.transform.x-s.transform.x,n.y=h.transform.y-s.transform.y,n.skewX=t.Transform.normalizeRadian(h.transform.skewX-s.transform.skewX),n.skewY=t.Transform.normalizeRadian(h.transform.skewY-s.transform.skewY),n.scaleX=h.transform.scaleX-s.transform.scaleX,n.scaleY=h.transform.scaleY-s.transform.scaleY,n.x=s.transform.x+n.x*o,n.y=s.transform.y+n.y*o,n.skewX=s.transform.skewX+n.skewX*o,n.skewY=s.transform.skewY+n.skewY*o,n.scaleX=s.transform.scaleX+n.scaleX*o,n.scaleY=s.transform.scaleY+n.scaleY*o}n.add(i.originalTransform)},e.prototype._globalToLocal=function(t){for(var e=new Array,i=t.sortedBones.concat().reverse(),a=0,n=i.length;a<n;++a){var r=i[a];r.parent&&(r.parent.transform.toMatrix(this._helpMatrix),this._helpMatrix.invert(),this._helpMatrix.transformPoint(r.transform.x,r.transform.y,this._helpPoint),r.transform.x=this._helpPoint.x,r.transform.y=this._helpPoint.y,r.transform.rotation-=r.parent.transform.rotation);for(var s in t.animations){var o=t.animations[s],h=o.getBoneTimeline(r.name);if(h){var l=r.parent?o.getBoneTimeline(r.parent.name):null;this._helpTransformB.copyFrom(h.originalTransform),e.length=0;for(var _=0,u=h.frames.length;_<u;++_){var m=h.frames[_];e.indexOf(m)>=0||(e.push(m),l?(this._getTimelineFrameMatrix(o,l,m.position,this._helpTransformA),m.transform.add(this._helpTransformB),this._helpTransformA.toMatrix(this._helpMatrix),this._helpMatrix.invert(),this._helpMatrix.transformPoint(m.transform.x,m.transform.y,this._helpPoint),m.transform.x=this._helpPoint.x,m.transform.y=this._helpPoint.y,m.transform.rotation-=this._helpTransformA.rotation):m.transform.add(this._helpTransformB),m.transform.minus(r.transform),0===_?(h.originalTransform.copyFrom(m.transform),m.transform.identity()):m.transform.minus(h.originalTransform))}}}}},e.prototype._mergeFrameToAnimationTimeline=function(e,i,a){var n=Math.floor(e*this._armature.frameRate),r=this._animation.frames;if(0===r.length){var s=t.BaseObject.borrowObject(t.AnimationFrameData);if(s.position=0,this._animation.frameCount>1){r.length=this._animation.frameCount+1;var o=t.BaseObject.borrowObject(t.AnimationFrameData);o.position=this._animation.frameCount/this._armature.frameRate,r[0]=s,r[this._animation.frameCount]=o}}var h=null,l=r[n];if(!l||0!==n&&r[n-1]!==l.prev){h=t.BaseObject.borrowObject(t.AnimationFrameData),h.position=n/this._armature.frameRate,r[n]=h;for(var _=n+1,u=r.length;_<u;++_)l&&r[_]===l&&(r[_]=null)}else h=l;if(i)for(var _=0,u=i.length;_<u;++_)h.actions.push(i[_]);if(a)for(var _=0,u=a.length;_<u;++_)h.events.push(a[_]);for(var m=null,f=null,_=0,u=r.length;_<u;++_){var c=r[_];c&&f!==c?(f=c,m&&(f.prev=m,m.next=f,m.duration=f.position-m.position),m=f):r[_]=m}f.duration=this._animation.duration-f.position,f=r[0],m.next=f,f.prev=m},e.parseDragonBonesData=function(e){return t.ObjectDataParser.getInstance().parseDragonBonesData(e)},e.parseTextureAtlasData=function(i,a){void 0===a&&(a=1);for(var n={},r=i[e.SUB_TEXTURE],s=0,o=r.length;s<o;s++){var h=r[s],l=h[e.NAME],_=new t.Rectangle,u=null;_.x=h[e.X]/a,_.y=h[e.Y]/a,_.width=h[e.WIDTH]/a,_.height=h[e.HEIGHT]/a,e.FRAME_WIDTH in h&&(u=new t.Rectangle,u.x=h[e.FRAME_X]/a,u.y=h[e.FRAME_Y]/a,u.width=h[e.FRAME_WIDTH]/a,u.height=h[e.FRAME_HEIGHT]/a),n[l]={region:_,frame:u,rotated:!1}}return n},e}();e.DATA_VERSION_2_3="2.3",e.DATA_VERSION_3_0="3.0",e.DATA_VERSION_4_0="4.0",e.DATA_VERSION_4_5="4.5",e.DATA_VERSION_5_0="5.0",e.DATA_VERSION=e.DATA_VERSION_5_0,e.DATA_VERSIONS=[e.DATA_VERSION_5_0,e.DATA_VERSION_4_5,e.DATA_VERSION_4_0,e.DATA_VERSION_3_0,e.DATA_VERSION_2_3],e.TEXTURE_ATLAS="TextureAtlas",e.SUB_TEXTURE="SubTexture",e.FORMAT="format",e.IMAGE_PATH="imagePath",e.WIDTH="width",e.HEIGHT="height",e.ROTATED="rotated",e.FRAME_X="frameX",e.FRAME_Y="frameY",e.FRAME_WIDTH="frameWidth",e.FRAME_HEIGHT="frameHeight",e.DRADON_BONES="dragonBones",e.ARMATURE="armature",e.BONE="bone",e.IK="ik",e.SLOT="slot",e.SKIN="skin",e.DISPLAY="display",e.ANIMATION="animation",e.Z_ORDER="zOrder",e.FFD="ffd",e.FRAME="frame",e.ACTIONS="actions",e.EVENTS="events",e.INTS="ints",e.FLOATS="floats",e.STRINGS="strings",e.PIVOT="pivot",e.TRANSFORM="transform",e.AABB="aabb",e.COLOR="color",e.VERSION="version",e.COMPATIBLE_VERSION="compatibleVersion",e.FRAME_RATE="frameRate",e.TYPE="type",e.SUB_TYPE="subType",e.NAME="name",e.PARENT="parent",e.TARGET="target",e.SHARE="share",e.PATH="path",e.LENGTH="length",e.DISPLAY_INDEX="displayIndex",e.BLEND_MODE="blendMode",e.INHERIT_TRANSLATION="inheritTranslation",e.INHERIT_ROTATION="inheritRotation",e.INHERIT_SCALE="inheritScale",e.INHERIT_REFLECTION="inheritReflection",e.INHERIT_ANIMATION="inheritAnimation",e.INHERIT_FFD="inheritFFD",e.BEND_POSITIVE="bendPositive",e.CHAIN="chain",e.WEIGHT="weight",e.FADE_IN_TIME="fadeInTime",e.PLAY_TIMES="playTimes",e.SCALE="scale",e.OFFSET="offset",e.POSITION="position",e.DURATION="duration",e.TWEEN_TYPE="tweenType",e.TWEEN_EASING="tweenEasing",e.TWEEN_ROTATE="tweenRotate",e.TWEEN_SCALE="tweenScale",e.CURVE="curve",e.EVENT="event",e.SOUND="sound",e.ACTION="action",e.DEFAULT_ACTIONS="defaultActions",e.X="x",e.Y="y",e.SKEW_X="skX",e.SKEW_Y="skY",e.SCALE_X="scX",e.SCALE_Y="scY",e.ALPHA_OFFSET="aO",e.RED_OFFSET="rO",e.GREEN_OFFSET="gO",e.BLUE_OFFSET="bO",e.ALPHA_MULTIPLIER="aM",e.RED_MULTIPLIER="rM",e.GREEN_MULTIPLIER="gM",e.BLUE_MULTIPLIER="bM",e.UVS="uvs",e.VERTICES="vertices",e.TRIANGLES="triangles",e.WEIGHTS="weights",e.SLOT_POSE="slotPose",e.BONE_POSE="bonePose",e.COLOR_TRANSFORM="colorTransform",e.TIMELINE="timeline",e.IS_GLOBAL="isGlobal",e.PIVOT_X="pX",e.PIVOT_Y="pY",e.Z="z",e.LOOP="loop",e.AUTO_TWEEN="autoTween",e.HIDE="hide",e.DEFAULT_NAME="__default",t.DataParser=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i._getBoolean=function(t,e,i){if(e in t){var a=t[e],n=typeof a;if("boolean"===n)return a;if("string"!==n)return!!a;switch(a){case"0":case"NaN":case"":case"false":case"null":case"undefined":return!1;default:return!0}}return i},i._getNumber=function(t,e,i){if(e in t){var a=t[e];return null==a||"NaN"===a?i:+a||0}return i},i._getString=function(t,e,i){return e in t?String(t[e]):i},i.prototype._parseArmature=function(e,a){var n=t.BaseObject.borrowObject(t.ArmatureData);if(n.isRightTransform=i.DATA_VERSIONS.indexOf(this._data.version)>i.DATA_VERSIONS.indexOf(i.DATA_VERSION_4_5),n.name=i._getString(e,i.NAME,null),n.frameRate=i._getNumber(e,i.FRAME_RATE,this._data.frameRate),n.scale=a,0===n.frameRate&&(n.frameRate=24),i.TYPE in e&&"string"==typeof e[i.TYPE]?n.type=i._getArmatureType(e[i.TYPE]):n.type=i._getNumber(e,i.TYPE,0),this._armature=n,this._rawBones.length=0,i.AABB in e){var r=e[i.AABB];n.aabb.x=i._getNumber(r,i.X,0),n.aabb.y=i._getNumber(r,i.Y,0),n.aabb.width=i._getNumber(r,i.WIDTH,0),n.aabb.height=i._getNumber(r,i.HEIGHT,0)}if(i.BONE in e)for(var s=e[i.BONE],o=0,h=s.length;o<h;++o){var l=s[o],_=this._parseBone(l);n.addBone(_,i._getString(l,i.PARENT,null)),this._rawBones.push(_)}if(i.IK in e)for(var u=e[i.IK],o=0,h=u.length;o<h;++o)this._parseIK(u[o]);if(i.SLOT in e)for(var m=e[i.SLOT],f=0,o=0,h=m.length;o<h;++o)n.addSlot(this._parseSlot(m[o],f++));if(i.SKIN in e)for(var c=e[i.SKIN],o=0,h=c.length;o<h;++o)n.addSkin(this._parseSkin(c[o]));if(i.ANIMATION in e)for(var p=e[i.ANIMATION],o=0,h=p.length;o<h;++o)n.addAnimation(this._parseAnimation(p[o]));return(i.ACTIONS in e||i.DEFAULT_ACTIONS in e)&&this._parseActionData(e,n.actions,null,null),this._isOldData&&this._isGlobalTransform&&this._globalToLocal(n),this._armature=null,this._rawBones.length=0,n},i.prototype._parseBone=function(e){var a=t.BaseObject.borrowObject(t.BoneData);return a.inheritTranslation=i._getBoolean(e,i.INHERIT_TRANSLATION,!0),a.inheritRotation=i._getBoolean(e,i.INHERIT_ROTATION,!0),a.inheritScale=i._getBoolean(e,i.INHERIT_SCALE,!0),a.inheritReflection=i._getBoolean(e,i.INHERIT_REFLECTION,!0),a.length=i._getNumber(e,i.LENGTH,0)*this._armature.scale,a.name=i._getString(e,i.NAME,null),i.TRANSFORM in e&&this._parseTransform(e[i.TRANSFORM],a.transform),this._isOldData&&(a.inheritScale=!1),a},i.prototype._parseIK=function(t){var e=this._armature.getBone(i._getString(t,i.BONE in t?i.BONE:i.NAME,null));e&&(e.bendPositive=i._getBoolean(t,i.BEND_POSITIVE,!0),e.chain=i._getNumber(t,i.CHAIN,0),e.weight=i._getNumber(t,i.WEIGHT,1),e.ik=this._armature.getBone(i._getString(t,i.TARGET,null)),e.chain>0&&e.parent&&!e.parent.ik?(e.parent.ik=e.ik,e.parent.chainIndex=0,e.parent.chain=0,e.chainIndex=1):(e.chain=0,e.chainIndex=0))},i.prototype._parseSlot=function(e,a){var n=t.BaseObject.borrowObject(t.SlotData);return n.displayIndex=i._getNumber(e,i.DISPLAY_INDEX,0),n.zOrder=i._getNumber(e,i.Z,a),n.name=i._getString(e,i.NAME,null),n.parent=this._armature.getBone(i._getString(e,i.PARENT,null)),i.COLOR in e||i.COLOR_TRANSFORM in e?(n.color=t.SlotData.generateColor(),this._parseColorTransform(e[i.COLOR]||e[i.COLOR_TRANSFORM],n.color)):n.color=t.SlotData.DEFAULT_COLOR,i.BLEND_MODE in e&&"string"==typeof e[i.BLEND_MODE]?n.blendMode=i._getBlendMode(e[i.BLEND_MODE]):n.blendMode=i._getNumber(e,i.BLEND_MODE,0),(i.ACTIONS in e||i.DEFAULT_ACTIONS in e)&&this._parseActionData(e,n.actions,null,null),this._isOldData&&(i.COLOR_TRANSFORM in e?(n.color=t.SlotData.generateColor(),this._parseColorTransform(e[i.COLOR_TRANSFORM],n.color)):n.color=t.SlotData.DEFAULT_COLOR),n},i.prototype._parseSkin=function(e){var a=t.BaseObject.borrowObject(t.SkinData);if(a.name=i._getString(e,i.NAME,i.DEFAULT_NAME),a.name||(a.name=i.DEFAULT_NAME),i.SLOT in e){this._skin=a;for(var n=e[i.SLOT],r=0,s=0,o=n.length;s<o;++s)this._isOldData&&this._armature.addSlot(this._parseSlot(n[s],r++)),a.addSlot(this._parseSkinSlotData(n[s]));this._skin=null}return a},i.prototype._parseSkinSlotData=function(e){var a=t.BaseObject.borrowObject(t.SkinSlotData);if(a.slot=this._armature.getSlot(i._getString(e,i.NAME,null)),i.DISPLAY in e){var n=e[i.DISPLAY];this._skinSlotData=a;for(var r=0,s=n.length;r<s;++r)a.displays.push(this._parseDisplay(n[r]));this._skinSlotData=null}return a},i.prototype._parseDisplay=function(e){var a=t.BaseObject.borrowObject(t.DisplayData);if(a.inheritAnimation=i._getBoolean(e,i.INHERIT_ANIMATION,!0),a.name=i._getString(e,i.NAME,null),a.path=i._getString(e,i.PATH,a.name),i.TYPE in e&&"string"==typeof e[i.TYPE]?a.type=i._getDisplayType(e[i.TYPE]):a.type=i._getNumber(e,i.TYPE,0),a.isRelativePivot=!0,i.PIVOT in e){var n=e[i.PIVOT];a.pivot.x=i._getNumber(n,i.X,0),a.pivot.y=i._getNumber(n,i.Y,0)}else if(this._isOldData){var r=e[i.TRANSFORM];a.isRelativePivot=!1,a.pivot.x=i._getNumber(r,i.PIVOT_X,0)*this._armature.scale,a.pivot.y=i._getNumber(r,i.PIVOT_Y,0)*this._armature.scale}else a.pivot.x=.5,a.pivot.y=.5;switch(i.TRANSFORM in e&&this._parseTransform(e[i.TRANSFORM],a.transform),a.type){case 0:break;case 1:break;case 2:a.share=i._getString(e,i.SHARE,null),a.share||(a.inheritAnimation=i._getBoolean(e,i.INHERIT_FFD,!0),a.mesh=this._parseMesh(e),this._skinSlotData.addMesh(a.mesh));break;case 3:a.boundingBox=this._parseBoundingBox(e)}return a},i.prototype._parseMesh=function(e){var a=t.BaseObject.borrowObject(t.MeshData),n=e[i.VERTICES],r=e[i.UVS],s=e[i.TRIANGLES],o=Math.floor(n.length/2),h=Math.floor(s.length/3),l=new Array(this._armature.sortedBones.length);if(a.skinned=i.WEIGHTS in e&&e[i.WEIGHTS].length>0,a.name=i._getString(e,i.NAME,null),a.uvs.length=2*o,a.vertices.length=2*o,a.vertexIndices.length=3*h,a.skinned){if(a.boneIndices.length=o,a.weights.length=o,a.boneVertices.length=o,i.SLOT_POSE in e){var _=e[i.SLOT_POSE];a.slotPose.a=_[0],a.slotPose.b=_[1],a.slotPose.c=_[2],a.slotPose.d=_[3],a.slotPose.tx=_[4]*this._armature.scale,a.slotPose.ty=_[5]*this._armature.scale}if(i.BONE_POSE in e)for(var u=e[i.BONE_POSE],m=0,f=u.length;m<f;m+=7){var c=u[m],p=l[c]=new t.Matrix;p.a=u[m+1],p.b=u[m+2],p.c=u[m+3],p.d=u[m+4],p.tx=u[m+5]*this._armature.scale,p.ty=u[m+6]*this._armature.scale,p.invert()}}for(var m=0,d=0,f=n.length;m<f;m+=2){var g=m+1,y=m/2,b=a.vertices[m]=n[m]*this._armature.scale,T=a.vertices[g]=n[g]*this._armature.scale;if(a.uvs[m]=r[m],a.uvs[g]=r[g],a.skinned){var v=e[i.WEIGHTS],D=v[d],O=a.boneIndices[y]=new Array(D),S=a.weights[y]=new Array(D),x=a.boneVertices[y]=new Array(2*D);a.slotPose.transformPoint(b,T,this._helpPoint),b=a.vertices[m]=this._helpPoint.x,T=a.vertices[g]=this._helpPoint.y;for(var E=0;E<D;++E){var A=d+1+2*E,c=v[A],M=this._rawBones[c],w=a.bones.indexOf(M);w<0&&(w=a.bones.length,a.bones[w]=M,a.inverseBindPose[w]=l[c]),a.inverseBindPose[w].transformPoint(b,T,this._helpPoint),O[E]=w,S[E]=v[A+1],x[2*E]=this._helpPoint.x,x[2*E+1]=this._helpPoint.y}d+=2*D+1}}for(var m=0,f=s.length;m<f;++m)a.vertexIndices[m]=s[m];return a},i.prototype._parseBoundingBox=function(e){var a=t.BaseObject.borrowObject(t.BoundingBoxData);switch(i.SUB_TYPE in e&&"string"==typeof e[i.SUB_TYPE]?a.type=i._getBoundingBoxType(e[i.SUB_TYPE]):a.type=i._getNumber(e,i.SUB_TYPE,0),a.color=i._getNumber(e,i.COLOR,0),a.type){case 0:case 1:a.width=i._getNumber(e,i.WIDTH,0),a.height=i._getNumber(e,i.HEIGHT,0);break;case 2:if(i.VERTICES in e){var n=e[i.VERTICES];a.vertices.length=n.length;for(var r=0,s=a.vertices.length;r<s;r+=2){var o=r+1,h=n[r],l=n[o];a.vertices[r]=h,a.vertices[o]=l,0===r?(a.x=h,a.y=l,a.width=h,a.height=l):(h<a.x?a.x=h:h>a.width&&(a.width=h),l<a.y?a.y=l:l>a.height&&(a.height=l))}}}return a},i.prototype._parseAnimation=function(e){var a=t.BaseObject.borrowObject(t.AnimationData);if(a.frameCount=Math.max(i._getNumber(e,i.DURATION,1),1),a.playTimes=i._getNumber(e,i.PLAY_TIMES,1),a.duration=a.frameCount/this._armature.frameRate,a.fadeInTime=i._getNumber(e,i.FADE_IN_TIME,0),a.name=i._getString(e,i.NAME,i.DEFAULT_NAME),a.name||(a.name=i.DEFAULT_NAME),this._animation=a,this._parseTimeline(e,a,this._parseAnimationFrame),i.Z_ORDER in e&&(a.zOrderTimeline=t.BaseObject.borrowObject(t.ZOrderTimelineData),this._parseTimeline(e[i.Z_ORDER],a.zOrderTimeline,this._parseZOrderFrame)),i.BONE in e)for(var n=e[i.BONE],r=0,s=n.length;r<s;++r)a.addBoneTimeline(this._parseBoneTimeline(n[r]));if(i.SLOT in e)for(var o=e[i.SLOT],r=0,s=o.length;r<s;++r)a.addSlotTimeline(this._parseSlotTimeline(o[r]));if(i.FFD in e)for(var h=e[i.FFD],r=0,s=h.length;r<s;++r)a.addFFDTimeline(this._parseFFDTimeline(h[r]));if(this._isOldData){if(this._isAutoTween=i._getBoolean(e,i.AUTO_TWEEN,!0),this._animationTweenEasing=i._getNumber(e,i.TWEEN_EASING,0)||0,a.playTimes=i._getNumber(e,i.LOOP,1),i.TIMELINE in e)for(var l=e[i.TIMELINE],r=0,s=l.length;r<s;++r){var _=l[r];a.addBoneTimeline(this._parseBoneTimeline(_)),a.addSlotTimeline(this._parseSlotTimeline(_))}}else this._isAutoTween=!1,this._animationTweenEasing=0;for(var r in this._armature.bones){var u=this._armature.bones[r];if(!a.getBoneTimeline(u.name)){var m=t.BaseObject.borrowObject(t.BoneTimelineData),f=t.BaseObject.borrowObject(t.BoneFrameData);m.bone=u,m.frames[0]=f,a.addBoneTimeline(m)}}for(var r in this._armature.slots){var c=this._armature.slots[r];if(!a.getSlotTimeline(c.name)){var p=t.BaseObject.borrowObject(t.SlotTimelineData),d=t.BaseObject.borrowObject(t.SlotFrameData);p.slot=c,d.displayIndex=c.displayIndex,c.color===t.SlotData.DEFAULT_COLOR?d.color=t.SlotFrameData.DEFAULT_COLOR:(d.color=t.SlotFrameData.generateColor(),d.color.copyFrom(c.color)),p.frames[0]=d,a.addSlotTimeline(p),this._isOldData&&(d.displayIndex=-1)}}return this._animation=null,a},i.prototype._parseBoneTimeline=function(e){var a=t.BaseObject.borrowObject(t.BoneTimelineData);a.bone=this._armature.getBone(i._getString(e,i.NAME,null)),this._parseTimeline(e,a,this._parseBoneFrame);for(var n=a.originalTransform,r=null,s=0,o=a.frames.length;s<o;++s){var h=a.frames[s];r?r!==h&&h.transform.minus(n):(n.copyFrom(h.transform),h.transform.identity(),0===n.scaleX&&(n.scaleX=.001),0===n.scaleY&&(n.scaleY=.001)),r=h}return this._isOldData&&(i.PIVOT_X in e||i.PIVOT_Y in e)?(this._timelinePivot.x=i._getNumber(e,i.PIVOT_X,0)*this._armature.scale,this._timelinePivot.y=i._getNumber(e,i.PIVOT_Y,0)*this._armature.scale):this._timelinePivot.clear(),a},i.prototype._parseSlotTimeline=function(e){var a=t.BaseObject.borrowObject(t.SlotTimelineData);return a.slot=this._armature.getSlot(i._getString(e,i.NAME,null)),this._parseTimeline(e,a,this._parseSlotFrame),a},i.prototype._parseFFDTimeline=function(e){var a=t.BaseObject.borrowObject(t.FFDTimelineData);a.skin=this._armature.getSkin(i._getString(e,i.SKIN,null)),a.slot=a.skin.getSlot(i._getString(e,i.SLOT,null));for(var n=i._getString(e,i.NAME,null),r=0,s=a.slot.displays.length;r<s;++r){var o=a.slot.displays[r];if(o.mesh&&o.name===n){a.display=o;break}}return this._parseTimeline(e,a,this._parseFFDFrame),a},i.prototype._parseAnimationFrame=function(e,a,n){var r=t.BaseObject.borrowObject(t.AnimationFrameData);return this._parseFrame(e,r,a,n),(i.ACTION in e||i.ACTIONS in e)&&this._parseActionData(e,r.actions,null,null),(i.EVENTS in e||i.EVENT in e||i.SOUND in e)&&this._parseEventData(e,r.events,null,null),r},i.prototype._parseZOrderFrame=function(e,a,n){var r=t.BaseObject.borrowObject(t.ZOrderFrameData);this._parseFrame(e,r,a,n);var s=e[i.Z_ORDER];if(s&&s.length>0){var o=this._armature.sortedSlots.length,h=new Array(o-s.length/2);r.zOrder.length=o;for(var l=0;l<o;++l)r.zOrder[l]=-1;for(var _=0,u=0,m=0,f=s.length;m<f;m+=2){for(var c=s[m],p=s[m+1];_!==c;)h[u++]=_++;r.zOrder[_+p]=_++}for(;_<o;)h[u++]=_++;for(var d=o;d--;)r.zOrder[d]===-1&&(r.zOrder[d]=h[--u])}return r},i.prototype._parseBoneFrame=function(e,a,n){var r=t.BaseObject.borrowObject(t.BoneFrameData);if(r.tweenRotate=i._getNumber(e,i.TWEEN_ROTATE,0),r.tweenScale=i._getBoolean(e,i.TWEEN_SCALE,!0),this._parseTweenFrame(e,r,a,n),i.TRANSFORM in e){var s=e[i.TRANSFORM];this._parseTransform(s,r.transform),this._isOldData&&(this._helpPoint.x=this._timelinePivot.x+i._getNumber(s,i.PIVOT_X,0)*this._armature.scale,this._helpPoint.y=this._timelinePivot.y+i._getNumber(s,i.PIVOT_Y,0)*this._armature.scale,r.transform.toMatrix(this._helpMatrix),this._helpMatrix.transformPoint(this._helpPoint.x,this._helpPoint.y,this._helpPoint,!0),r.transform.x+=this._helpPoint.x,r.transform.y+=this._helpPoint.y)}var o=this._timeline.bone,h=new Array,l=new Array;if(i.ACTION in e||i.ACTIONS in e){var _=this._armature.getSlot(o.name);this._parseActionData(e,h,o,_)}return(i.EVENT in e||i.SOUND in e)&&this._parseEventData(e,l,o,null),(h.length>0||l.length>0)&&this._mergeFrameToAnimationTimeline(r.position,h,l),r},i.prototype._parseSlotFrame=function(e,a,n){var r=t.BaseObject.borrowObject(t.SlotFrameData);if(r.displayIndex=i._getNumber(e,i.DISPLAY_INDEX,0),this._parseTweenFrame(e,r,a,n),i.COLOR in e||i.COLOR_TRANSFORM in e?(r.color=t.SlotFrameData.generateColor(),this._parseColorTransform(e[i.COLOR]||e[i.COLOR_TRANSFORM],r.color)):r.color=t.SlotFrameData.DEFAULT_COLOR,this._isOldData)i._getBoolean(e,i.HIDE,!1)&&(r.displayIndex=-1);else if(i.ACTION in e||i.ACTIONS in e){var s=this._timeline.slot,o=new Array;this._parseActionData(e,o,s.parent,s),this._mergeFrameToAnimationTimeline(r.position,o,null)}return r},i.prototype._parseFFDFrame=function(e,a,n){var r=this._timeline,s=r.display.mesh,o=t.BaseObject.borrowObject(t.ExtensionFrameData);this._parseTweenFrame(e,o,a,n);for(var h=e[i.VERTICES],l=i._getNumber(e,i.OFFSET,0),_=0,u=0,m=0,f=s.vertices.length;m<f;m+=2)if(!h||m<l||m-l>=h.length?(_=0,u=0):(_=h[m-l]*this._armature.scale,u=h[m+1-l]*this._armature.scale),s.skinned){s.slotPose.transformPoint(_,u,this._helpPoint,!0),_=this._helpPoint.x,u=this._helpPoint.y;for(var c=s.boneIndices[m/2],p=0,d=c.length;p<d;++p){var g=c[p];s.inverseBindPose[g].transformPoint(_,u,this._helpPoint,!0),o.tweens.push(this._helpPoint.x,this._helpPoint.y)}}else o.tweens.push(_,u);return o},i.prototype._parseTweenFrame=function(e,a,n,r){this._parseFrame(e,a,n,r),a.duration>0?(i.TWEEN_EASING in e?a.tweenEasing=i._getNumber(e,i.TWEEN_EASING,t.DragonBones.NO_TWEEN):this._isOldData?a.tweenEasing=this._isAutoTween?this._animationTweenEasing:t.DragonBones.NO_TWEEN:a.tweenEasing=t.DragonBones.NO_TWEEN,this._isOldData&&1===this._animation.scale&&1===this._timeline.scale&&a.duration*this._armature.frameRate<2&&(a.tweenEasing=t.DragonBones.NO_TWEEN),r>0&&i.CURVE in e&&(a.curve=new Array(2*r-1),t.TweenFrameData.samplingEasingCurve(e[i.CURVE],a.curve))):(a.tweenEasing=t.DragonBones.NO_TWEEN,a.curve=null)},i.prototype._parseFrame=function(t,e,i,a){e.position=i/this._armature.frameRate,e.duration=a/this._armature.frameRate},i.prototype._parseTimeline=function(e,a,n){if(a.scale=i._getNumber(e,i.SCALE,1),a.offset=i._getNumber(e,i.OFFSET,0),this._timeline=a,i.FRAME in e){var r=e[i.FRAME];if(1===r.length)a.frames.length=1,a.frames[0]=n.call(this,r[0],0,i._getNumber(r[0],i.DURATION,1));else if(r.length>1){a.frames.length=this._animation.frameCount+1;for(var s=0,o=0,h=null,l=null,_=0,u=0,m=a.frames.length;_<m;++_){if(s+o<=_&&u<r.length){var f=r[u++];s=_,o=i._getNumber(f,i.DURATION,1),h=n.call(this,f,s,o),l&&(l.next=h,h.prev=l,this._isOldData&&l instanceof t.TweenFrameData&&i._getNumber(f,i.DISPLAY_INDEX,0)===-1&&(l.tweenEasing=t.DragonBones.NO_TWEEN)),l=h}a.frames[_]=h}h.duration=this._animation.duration-h.position,h=a.frames[0],l.next=h,h.prev=l,this._isOldData&&l instanceof t.TweenFrameData&&i._getNumber(r[0],i.DISPLAY_INDEX,0)===-1&&(l.tweenEasing=t.DragonBones.NO_TWEEN)}}this._timeline=null},i.prototype._parseActionData=function(e,a,n,r){var s=e[i.ACTION]||e[i.ACTIONS]||e[i.DEFAULT_ACTIONS];if("string"==typeof s){var o=t.BaseObject.borrowObject(t.ActionData);o.type=0,o.bone=n,o.slot=r,o.animationConfig=t.BaseObject.borrowObject(t.AnimationConfig),o.animationConfig.animationName=s,a.push(o)}else if(s instanceof Array)for(var h=0,l=s.length;h<l;++h){var _=s[h],u=_ instanceof Array,o=t.BaseObject.borrowObject(t.ActionData),m=u?_[1]:i._getString(_,"gotoAndPlay",null);if(u){var f=_[0];"string"==typeof f?o.type=i._getActionType(f):o.type=f}else o.type=0;switch(o.type){case 0:o.animationConfig=t.BaseObject.borrowObject(t.AnimationConfig),o.animationConfig.animationName=m}o.bone=n,o.slot=r,a.push(o)}},i.prototype._parseEventData=function(e,a,n,r){if(i.SOUND in e){var s=t.BaseObject.borrowObject(t.EventData);s.type=11,s.name=i._getString(e,i.SOUND,null),s.bone=n,s.slot=r,a.push(s)}if(i.EVENT in e){var o=t.BaseObject.borrowObject(t.EventData);o.type=10,o.name=i._getString(e,i.EVENT,null),o.bone=n,o.slot=r,a.push(o)}if(i.EVENTS in e)for(var h=e[i.EVENTS],l=0,_=h.length;l<_;++l){var u=h[l],m=i._getString(u,i.BONE,null),f=i._getString(u,i.SLOT,null),o=t.BaseObject.borrowObject(t.EventData);if(o.type=10,o.name=i._getString(u,i.NAME,null),o.bone=this._armature.getBone(m),o.slot=this._armature.getSlot(f),i.INTS in u){o.data||(o.data=t.BaseObject.borrowObject(t.CustomData));for(var c=u[i.INTS],p=0,d=c.length;p<d;++p)o.data.ints.push(c[p])}if(i.FLOATS in u){o.data||(o.data=t.BaseObject.borrowObject(t.CustomData));for(var g=u[i.FLOATS],y=0,b=g.length;y<b;++y)o.data.floats.push(g[y])}if(i.STRINGS in u){o.data||(o.data=t.BaseObject.borrowObject(t.CustomData));for(var T=u[i.STRINGS],v=0,D=T.length;v<D;++v)o.data.strings.push(T[v])}a.push(o)}},i.prototype._parseTransform=function(e,a){a.x=i._getNumber(e,i.X,0)*this._armature.scale,a.y=i._getNumber(e,i.Y,0)*this._armature.scale,a.skewX=i._getNumber(e,i.SKEW_X,0)*t.DragonBones.ANGLE_TO_RADIAN,a.skewY=i._getNumber(e,i.SKEW_Y,0)*t.DragonBones.ANGLE_TO_RADIAN,a.scaleX=i._getNumber(e,i.SCALE_X,1),a.scaleY=i._getNumber(e,i.SCALE_Y,1)},i.prototype._parseColorTransform=function(t,e){e.alphaMultiplier=.01*i._getNumber(t,i.ALPHA_MULTIPLIER,100),e.redMultiplier=.01*i._getNumber(t,i.RED_MULTIPLIER,100),e.greenMultiplier=.01*i._getNumber(t,i.GREEN_MULTIPLIER,100),e.blueMultiplier=.01*i._getNumber(t,i.BLUE_MULTIPLIER,100),e.alphaOffset=i._getNumber(t,i.ALPHA_OFFSET,0),e.redOffset=i._getNumber(t,i.RED_OFFSET,0),e.greenOffset=i._getNumber(t,i.GREEN_OFFSET,0),e.blueOffset=i._getNumber(t,i.BLUE_OFFSET,0)},i.prototype.parseDragonBonesData=function(e,a){if(void 0===a&&(a=1),e){var n=i._getString(e,i.VERSION,null),r=i._getString(e,i.COMPATIBLE_VERSION,null);if(this._isOldData=n===i.DATA_VERSION_2_3||n===i.DATA_VERSION_3_0,this._isOldData?this._isGlobalTransform=i._getBoolean(e,i.IS_GLOBAL,!0):this._isGlobalTransform=!1,i.DATA_VERSIONS.indexOf(n)>=0||i.DATA_VERSIONS.indexOf(r)>=0){var s=t.BaseObject.borrowObject(t.DragonBonesData);if(s.version=n,s.name=i._getString(e,i.NAME,null),s.frameRate=i._getNumber(e,i.FRAME_RATE,24),0===s.frameRate&&(s.frameRate=24),i.ARMATURE in e){this._data=s;for(var o=e[i.ARMATURE],h=0,l=o.length;h<l;++h)s.addArmature(this._parseArmature(o[h],a));this._data=null}return s}throw new Error("Nonsupport data version.")}throw new Error(t.DragonBones.ARGUMENT_ERROR)},i.prototype.parseTextureAtlasData=function(e,a,n){if(void 0===n&&(n=0),!e)throw new Error(t.DragonBones.ARGUMENT_ERROR);if(a.name=i._getString(e,i.NAME,null),a.imagePath=i._getString(e,i.IMAGE_PATH,null),a.width=i._getNumber(e,i.WIDTH,0),a.height=i._getNumber(e,i.HEIGHT,0),n>0?a.scale=n:n=a.scale=i._getNumber(e,i.SCALE,a.scale),n=1/n,i.SUB_TEXTURE in e)for(var r=e[i.SUB_TEXTURE],s=0,o=r.length;s<o;++s){var h=r[s],l=a.generateTexture();l.name=i._getString(h,i.NAME,null),l.rotated=i._getBoolean(h,i.ROTATED,!1),l.region.x=i._getNumber(h,i.X,0)*n,l.region.y=i._getNumber(h,i.Y,0)*n,l.region.width=i._getNumber(h,i.WIDTH,0)*n,l.region.height=i._getNumber(h,i.HEIGHT,0)*n;var _=i._getNumber(h,i.FRAME_WIDTH,-1),u=i._getNumber(h,i.FRAME_HEIGHT,-1);_>0&&u>0&&(l.frame=t.TextureData.generateRectangle(),l.frame.x=i._getNumber(h,i.FRAME_X,0)*n,l.frame.y=i._getNumber(h,i.FRAME_Y,0)*n,l.frame.width=_*n,l.frame.height=u*n),a.addTexture(l)}},i.getInstance=function(){return i._instance||(i._instance=new i),i._instance},i}(t.DataParser);e._instance=null,t.ObjectDataParser=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i.globalTransformMatrix=new t.Matrix,i.global=new t.Transform,i.offset=new t.Transform,i}return __extends(i,e),i.prototype._onClear=function(){this.name=null,this.global.identity(),this.offset.identity(),this.globalTransformMatrix.identity(),this.origin=null,this.userData=null,this._armature=null,this._parent=null,this._globalDirty=!1},i.prototype._setArmature=function(t){this._armature=t},i.prototype._setParent=function(t){this._parent=t},i.prototype.updateGlobalTransform=function(){this._globalDirty&&(this._globalDirty=!1,this.global.fromMatrix(this.globalTransformMatrix))},Object.defineProperty(i.prototype,"armature",{get:function(){return this._armature},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),i}(t.BaseObject);e._helpPoint=new t.Point,e._helpTransform=new t.Transform,e._helpMatrix=new t.Matrix,t.TransformObject=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._animationPose=new t.Transform,i._bones=[],i._slots=[],i}return __extends(i,e),i.toString=function(){return"[class dragonBones.Bone]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.ikBendPositive=!1,this.ikWeight=0,this._ikChain=0,this._ikChainIndex=0,this._ik=null,this._transformDirty=!1,this._childrenTransformDirty=!1,this._blendDirty=!1,this._visible=!0,this._cachedFrameIndex=-1,this._blendLayer=0,this._blendLeftWeight=1,this._blendTotalWeight=0,this._animationPose.identity(),this._bones.length=0,this._slots.length=0,this._boneData=null,this._cachedFrameIndices=null},i.prototype._updateGlobalTransformMatrix=function(e){var i=this._armature.flipX,a=this._armature.flipY===t.DragonBones.yDown,n=0;if(this.global.x=this.origin.x+this.offset.x+this._animationPose.x,this.global.y=this.origin.y+this.offset.y+this._animationPose.y,this.global.skewX=this.origin.skewX+this.offset.skewX+this._animationPose.skewX,this.global.skewY=this.origin.skewY+this.offset.skewY+this._animationPose.skewY,this.global.scaleX=this.origin.scaleX*this.offset.scaleX*this._animationPose.scaleX,this.global.scaleY=this.origin.scaleY*this.offset.scaleY*this._animationPose.scaleY,this._parent){var r=this._parent.globalTransformMatrix;if(this._boneData.inheritScale)this._boneData.inheritRotation||(this._parent.updateGlobalTransform(),n=this._parent.global.skewY,this.global.skewX-=n,this.global.skewY-=n),this.global.toMatrix(this.globalTransformMatrix),this.globalTransformMatrix.concat(r),this._boneData.inheritTranslation?(this.global.x=this.globalTransformMatrix.tx,this.global.y=this.globalTransformMatrix.ty):(this.globalTransformMatrix.tx=this.global.x,this.globalTransformMatrix.ty=this.global.y),e?this.global.fromMatrix(this.globalTransformMatrix):this._globalDirty=!0;else{if(this._boneData.inheritTranslation){var s=this.global.x,o=this.global.y;this.global.x=r.a*s+r.c*o+r.tx,this.global.y=r.d*o+r.b*s+r.ty}else i&&(this.global.x=-this.global.x),a&&(this.global.y=-this.global.y);this._boneData.inheritRotation?(this._parent.updateGlobalTransform(),
n=this._parent.global.skewY,this._armature._armatureData.isRightTransform&&r.a*r.d-r.b*r.c<0&&(n-=2*this.global.skewY,this._parent.global.scaleX<0&&(n+=Math.PI),(i!=a||this._boneData.inheritReflection)&&(this.global.skewX+=Math.PI)),this.global.skewX+=n,this.global.skewY+=n):(i||a)&&(i&&a?n=Math.PI:(n=2*-this.global.skewY,i&&(n+=Math.PI),this.global.skewX+=Math.PI),this.global.skewX+=n,this.global.skewY+=n),this.global.toMatrix(this.globalTransformMatrix)}}else(i||a)&&(i&&(this.global.x=-this.global.x),a&&(this.global.y=-this.global.y),i&&a?n=Math.PI:(n=2*-this.global.skewY,i&&(n+=Math.PI),this.global.skewX+=Math.PI),this.global.skewX+=n,this.global.skewY+=n),this.global.toMatrix(this.globalTransformMatrix);this._ik&&this._ikChainIndex===this._ikChain&&this.ikWeight>0&&(this._boneData.inheritTranslation&&this._ikChain>0&&this._parent?this._computeIKB():this._computeIKA())},i.prototype._computeIKA=function(){this.updateGlobalTransform();var t=this._boneData.length,e=this._ik.global,i=(this.globalTransformMatrix.a*t,this.globalTransformMatrix.b*t,Math.atan2(e.y-this.global.y,e.x-this.global.x));this.global.scaleX<0&&(i+=Math.PI);var a=(i-this.global.skewY)*this.ikWeight;this.global.skewX+=a,this.global.skewY+=a,this.global.toMatrix(this.globalTransformMatrix)},i.prototype._computeIKB=function(){this._parent.updateGlobalTransform(),this.updateGlobalTransform();var t=this._boneData.length,e=this._parent.global,i=this._ik.global,a=this.globalTransformMatrix.a*t,n=this.globalTransformMatrix.b*t,r=a*a+n*n,s=Math.sqrt(r),o=this.global.x-e.x,h=this.global.y-e.y,l=o*o+h*h,_=Math.sqrt(l),u=Math.atan2(h,o);o=i.x-e.x,h=i.y-e.y;var m=o*o+h*h,f=Math.sqrt(m),c=0;if(s+_<=f||f+s<=_||f+_<=s)c=Math.atan2(i.y-e.y,i.x-e.x),s+_<=f||_<s&&(c+=Math.PI);else{var p=(l-r+m)/(2*m),d=Math.sqrt(l-p*p*m)/f,g=e.x+o*p,y=e.y+h*p,b=-h*d,T=o*d,v=!1;if(this._parent._parent){var D=this._parent._parent.globalTransformMatrix;v=D.a*D.d-D.b*D.c<0}v!==this.ikBendPositive?(this.global.x=g-b,this.global.y=y-T):(this.global.x=g+b,this.global.y=y+T),c=Math.atan2(this.global.y-e.y,this.global.x-e.x)}var O=(c-u)*this.ikWeight;e.skewX+=O,e.skewY+=O,e.toMatrix(this._parent.globalTransformMatrix),this._parent._childrenTransformDirty=!0,this._parent._cachedFrameIndex>=0&&this._armature._armatureData.setCacheFrame(this._parent.globalTransformMatrix,e,this._parent._cachedFrameIndex);var S=u+O;this.global.x=e.x+Math.cos(S)*_,this.global.y=e.y+Math.sin(S)*_;var x=Math.atan2(i.y-this.global.y,i.x-this.global.x);this.global.scaleX<0&&(x+=Math.PI),O=(x-this.global.skewY)*this.ikWeight,this.global.skewX+=O,this.global.skewY+=O,this.global.toMatrix(this.globalTransformMatrix)},i.prototype._init=function(t){this._boneData||(this._boneData=t,this.name=this._boneData.name,this.origin=this._boneData.transform)},i.prototype._setArmature=function(t){if(this._armature!==t){this._ik=null;var e=null,i=null;if(this._armature&&(e=this.getSlots(),i=this.getBones(),this._armature._removeBoneFromBoneList(this)),this._armature=t,this._armature&&this._armature._addBoneToBoneList(this),e)for(var a=0,n=e.length;a<n;++a){var r=e[a];r.parent===this&&r._setArmature(this._armature)}if(i)for(var a=0,n=i.length;a<n;++a){var s=i[a];s.parent===this&&s._setArmature(this._armature)}}},i.prototype._setIK=function(t,e,i){if(t){if(e===i){var a=this._parent;if(e&&a?e=1:(e=0,i=0,a=this),a===t||a.contains(t))t=null,e=0,i=0;else for(var n=t;n.ik&&n.ikChain;){if(a.contains(n.ik)){t=null,e=0,i=0;break}n=n.parent}}}else e=0,i=0;this._ik=t,this._ikChain=e,this._ikChainIndex=i,this._armature&&(this._armature._bonesDirty=!0)},i.prototype._update=function(t){if(this._blendDirty=!1,t>=0&&this._cachedFrameIndices){var e=this._cachedFrameIndices[t];e>=0&&this._cachedFrameIndex===e?this._transformDirty=!1:e>=0?(this._transformDirty=!0,this._cachedFrameIndex=e):this._transformDirty||this._parent&&this._parent._childrenTransformDirty||this._ik&&this.ikWeight>0&&this._ik._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}else(this._transformDirty||this._parent&&this._parent._childrenTransformDirty||this._ik&&this.ikWeight>0&&this._ik._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1);if(this._transformDirty)if(this._transformDirty=!1,this._childrenTransformDirty=!0,this._cachedFrameIndex<0){var i=t>=0;this._updateGlobalTransformMatrix(i),i&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);else this._childrenTransformDirty&&(this._childrenTransformDirty=!1)},i.prototype.invalidUpdate=function(){this._transformDirty=!0},i.prototype.contains=function(t){if(t){if(t===this)return!1;for(var e=t;e!==this&&e;)e=e.parent;return e===this}return!1},i.prototype.getBones=function(){this._bones.length=0;for(var t=this._armature.getBones(),e=0,i=t.length;e<i;++e){var a=t[e];a.parent===this&&this._bones.push(a)}return this._bones},i.prototype.getSlots=function(){this._slots.length=0;for(var t=this._armature.getSlots(),e=0,i=t.length;e<i;++e){var a=t[e];a.parent===this&&this._slots.push(a)}return this._slots},Object.defineProperty(i.prototype,"boneData",{get:function(){return this._boneData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){return this._visible},set:function(t){if(this._visible!==t){this._visible=t;for(var e=this._armature.getSlots(),i=0,a=e.length;i<a;++i){var n=e[i];n._parent===this&&n._updateVisible()}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){return this.boneData.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"slot",{get:function(){for(var t=this._armature.getSlots(),e=0,i=t.length;e<i;++e){var a=t[e];if(a.parent===this)return a}return null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ikChain",{get:function(){return this._ikChain},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ikChainIndex",{get:function(){return this._ikChainIndex},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ik",{get:function(){return this._ik},enumerable:!0,configurable:!0}),i}(t.TransformObject);t.Bone=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var i=e.call(this)||this;return i._localMatrix=new t.Matrix,i._colorTransform=new t.ColorTransform,i._ffdVertices=[],i._displayList=[],i._textureDatas=[],i._replacedDisplayDatas=[],i._meshBones=[],i}return __extends(i,e),i.prototype._onClear=function(){e.prototype._onClear.call(this);for(var i=[],a=0,n=this._displayList.length;a<n;++a){var r=this._displayList[a];r!==this._rawDisplay&&r!==this._meshDisplay&&i.indexOf(r)<0&&i.push(r)}for(var a=0,n=i.length;a<n;++a){var r=i[a];r instanceof t.Armature?r.dispose():this._disposeDisplay(r)}this._meshDisplay&&this._meshDisplay!==this._rawDisplay&&this._disposeDisplay(this._meshDisplay),this._rawDisplay&&this._disposeDisplay(this._rawDisplay),this.displayController=null,this._displayDirty=!1,this._zOrderDirty=!1,this._blendModeDirty=!1,this._colorDirty=!1,this._meshDirty=!1,this._transformDirty=!1,this._blendMode=0,this._displayIndex=-1,this._zOrder=0,this._cachedFrameIndex=-1,this._pivotX=0,this._pivotY=0,this._localMatrix.identity(),this._colorTransform.identity(),this._ffdVertices.length=0,this._displayList.length=0,this._textureDatas.length=0,this._replacedDisplayDatas.length=0,this._meshBones.length=0,this._skinSlotData=null,this._displayData=null,this._replacedDisplayData=null,this._textureData=null,this._meshData=null,this._boundingBoxData=null,this._rawDisplay=null,this._meshDisplay=null,this._display=null,this._childArmature=null,this._cachedFrameIndices=null},i.prototype._isMeshBonesUpdate=function(){for(var t=0,e=this._meshBones.length;t<e;++t)if(this._meshBones[t]._childrenTransformDirty)return!0;return!1},i.prototype._updateDisplayData=function(){var t=this._displayData,e=this._replacedDisplayData,a=this._textureData,n=this._meshData,r=this._displayIndex>=0&&this._displayIndex<this._displayList.length?this._displayList[this._displayIndex]:null;if(this._displayIndex>=0&&this._displayIndex<this._skinSlotData.displays.length?this._displayData=this._skinSlotData.displays[this._displayIndex]:this._displayData=null,this._displayIndex>=0&&this._displayIndex<this._replacedDisplayDatas.length?this._replacedDisplayData=this._replacedDisplayDatas[this._displayIndex]:this._replacedDisplayData=null,this._displayData!==t||this._replacedDisplayData!==e||this._display!=r){var s=this._replacedDisplayData?this._replacedDisplayData:this._displayData;if(!s||r!==this._rawDisplay&&r!==this._meshDisplay)this._textureData=null,this._meshData=null,this._pivotX=0,this._pivotY=0,this._meshBones.length=0,this._ffdVertices.length=0;else{if(this._replacedDisplayData?this._textureData=this._replacedDisplayData.texture:this._displayIndex<this._textureDatas.length&&this._textureDatas[this._displayIndex]?this._textureData=this._textureDatas[this._displayIndex]:this._textureData=this._displayData.texture,r===this._meshDisplay?this._replacedDisplayData&&this._replacedDisplayData.mesh?this._meshData=this._replacedDisplayData.mesh:this._meshData=this._displayData.mesh:this._meshData=null,this._meshData)this._pivotX=0,this._pivotY=0;else if(this._textureData){var o=this._armature.armatureData.scale;if(this._pivotX=s.pivot.x,this._pivotY=s.pivot.y,s.isRelativePivot){var h=this._textureData.frame?this._textureData.frame:this._textureData.region,l=h.width*o,_=h.height*o;this._textureData.rotated&&(l=h.height,_=h.width),this._pivotX*=l,this._pivotY*=_}this._textureData.frame&&(this._pivotX+=this._textureData.frame.x*o,this._pivotY+=this._textureData.frame.y*o)}else this._pivotX=0,this._pivotY=0;if(!this._displayData||s===this._displayData||this._meshData&&this._meshData===this._displayData.mesh||(this._displayData.transform.toMatrix(i._helpMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(0,0,i._helpPoint),this._pivotX-=i._helpPoint.x,this._pivotY-=i._helpPoint.y,s.transform.toMatrix(i._helpMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(0,0,i._helpPoint),this._pivotX+=i._helpPoint.x,this._pivotY+=i._helpPoint.y),this._meshData!==n)if(this._meshData&&this._displayData&&this._meshData===this._displayData.mesh){if(this._meshData.skinned){this._meshBones.length=this._meshData.bones.length;for(var u=0,m=this._meshBones.length;u<m;++u)this._meshBones[u]=this._armature.getBone(this._meshData.bones[u].name);for(var f=0,u=0,m=this._meshData.boneIndices.length;u<m;++u)f+=this._meshData.boneIndices[u].length;this._ffdVertices.length=2*f}else this._meshBones.length=0,this._ffdVertices.length=this._meshData.vertices.length;for(var u=0,m=this._ffdVertices.length;u<m;++u)this._ffdVertices[u]=0;this._meshDirty=!0}else this._meshBones.length=0,this._ffdVertices.length=0;else this._textureData!==a&&(this._meshDirty=!0)}this._displayDirty=!0,this._transformDirty=!0,this._displayData?this.origin=this._displayData.transform:this._replacedDisplayData&&(this.origin=this._replacedDisplayData.transform)}this._replacedDisplayData?this._boundingBoxData=this._replacedDisplayData.boundingBox:this._displayData?this._boundingBoxData=this._displayData.boundingBox:this._boundingBoxData=null},i.prototype._updateDisplay=function(){var e=this._display||this._rawDisplay,i=this._childArmature;this._displayIndex>=0&&this._displayIndex<this._displayList.length?(this._display=this._displayList[this._displayIndex],this._display instanceof t.Armature?(this._childArmature=this._display,this._display=this._childArmature.display):this._childArmature=null):(this._display=null,this._childArmature=null);var a=this._display?this._display:this._rawDisplay;if(a!==e&&(this._onUpdateDisplay(),this._replaceDisplay(e),this._blendModeDirty=!0,this._colorDirty=!0),a!==this._rawDisplay&&a!==this._meshDisplay||this._updateFrame(),this._childArmature!==i&&(i&&(i._parent=null,i.clock=null,i.inheritAnimation&&i.animation.reset()),this._childArmature&&(this._childArmature._parent=this,this._childArmature.clock=this._armature.clock,this._childArmature.inheritAnimation))){if(0===this._childArmature.cacheFrameRate){var n=this._armature.cacheFrameRate;0!==n&&(this._childArmature.cacheFrameRate=n)}var r=this._skinSlotData.slot.actions.length>0?this._skinSlotData.slot.actions:this._childArmature.armatureData.actions;if(r.length>0)for(var s=0,o=r.length;s<o;++s)this._childArmature._bufferAction(r[s]);else this._childArmature.animation.play()}},i.prototype._updateGlobalTransformMatrix=function(t){this.globalTransformMatrix.copyFrom(this._localMatrix),this.globalTransformMatrix.concat(this._parent.globalTransformMatrix),t?this.global.fromMatrix(this.globalTransformMatrix):this._globalDirty=!0},i.prototype._init=function(t,e,i){if(!this._skinSlotData){this._skinSlotData=t;var a=this._skinSlotData.slot;this.name=a.name,this._zOrder=a.zOrder,this._blendMode=a.blendMode,this._colorTransform.copyFrom(a.color),this._rawDisplay=e,this._meshDisplay=i,this._blendModeDirty=!0,this._colorDirty=!0}},i.prototype._setArmature=function(t){this._armature!==t&&(this._armature&&this._armature._removeSlotFromSlotList(this),this._armature=t,this._onUpdateDisplay(),this._armature?(this._armature._addSlotToSlotList(this),this._addDisplay()):this._removeDisplay())},i.prototype._update=function(t){if(this._displayDirty&&(this._displayDirty=!1,this._updateDisplay(),this._transformDirty&&(this.origin?this.global.copyFrom(this.origin).add(this.offset).toMatrix(this._localMatrix):this.global.copyFrom(this.offset).toMatrix(this._localMatrix))),this._zOrderDirty&&(this._zOrderDirty=!1,this._updateZOrder()),t>=0&&this._cachedFrameIndices){var e=this._cachedFrameIndices[t];e>=0&&this._cachedFrameIndex===e?this._transformDirty=!1:e>=0?(this._transformDirty=!0,this._cachedFrameIndex=e):this._transformDirty||this._parent._childrenTransformDirty?(this._transformDirty=!0,this._cachedFrameIndex=-1):this._cachedFrameIndex>=0?(this._transformDirty=!1,this._cachedFrameIndices[t]=this._cachedFrameIndex):(this._transformDirty=!0,this._cachedFrameIndex=-1)}else(this._transformDirty||this._parent._childrenTransformDirty)&&(t=-1,this._transformDirty=!0,this._cachedFrameIndex=-1);if(this._display){if(this._blendModeDirty&&(this._blendModeDirty=!1,this._updateBlendMode()),this._colorDirty&&(this._colorDirty=!1,this._updateColor()),this._meshData&&this._displayData&&this._meshData===this._displayData.mesh&&((this._meshDirty||this._meshData.skinned&&this._isMeshBonesUpdate())&&(this._meshDirty=!1,this._updateMesh()),this._meshData.skinned))return void(this._transformDirty&&(this._transformDirty=!1,this._updateTransform(!0)));if(this._transformDirty){if(this._transformDirty=!1,this._cachedFrameIndex<0){var i=t>=0;this._updateGlobalTransformMatrix(i),i&&(this._cachedFrameIndex=this._cachedFrameIndices[t]=this._armature._armatureData.setCacheFrame(this.globalTransformMatrix,this.global))}else this._armature._armatureData.getCacheFrame(this.globalTransformMatrix,this.global,this._cachedFrameIndex);this._updateTransform(!1)}}},i.prototype._updateTransformAndMatrix=function(){this._transformDirty&&(this._transformDirty=!1,this._updateGlobalTransformMatrix(!1))},i.prototype._setDisplayList=function(e){if(e&&e.length>0){this._displayList.length!==e.length&&(this._displayList.length=e.length);for(var i=0,a=e.length;i<a;++i){var n=e[i];n&&n!==this._rawDisplay&&n!==this._meshDisplay&&!(n instanceof t.Armature)&&this._displayList.indexOf(n)<0&&this._initDisplay(n),this._displayList[i]=n}}else this._displayList.length>0&&(this._displayList.length=0);return this._displayIndex>=0&&this._displayIndex<this._displayList.length?this._displayDirty=this._display!==this._displayList[this._displayIndex]:this._displayDirty=null!=this._display,this._updateDisplayData(),this._displayDirty},i.prototype._setDisplayIndex=function(t){return this._displayIndex!==t&&(this._displayIndex=t,this._displayDirty=!0,this._updateDisplayData(),this._displayDirty)},i.prototype._setZorder=function(t){return this._zOrder===t,this._zOrder=t,this._zOrderDirty=!0,this._zOrderDirty},i.prototype._setColor=function(t){return this._colorTransform.copyFrom(t),this._colorDirty=!0,!0},i.prototype.containsPoint=function(t,e){return!!this._boundingBoxData&&(this._updateTransformAndMatrix(),i._helpMatrix.copyFrom(this.globalTransformMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(t,e,i._helpPoint),this._boundingBoxData.containsPoint(i._helpPoint.x,i._helpPoint.y))},i.prototype.intersectsSegment=function(t,e,a,n,r,s,o){if(void 0===r&&(r=null),void 0===s&&(s=null),void 0===o&&(o=null),!this._boundingBoxData)return 0;this._updateTransformAndMatrix(),i._helpMatrix.copyFrom(this.globalTransformMatrix),i._helpMatrix.invert(),i._helpMatrix.transformPoint(t,e,i._helpPoint),t=i._helpPoint.x,e=i._helpPoint.y,i._helpMatrix.transformPoint(a,n,i._helpPoint),a=i._helpPoint.x,n=i._helpPoint.y;var h=this._boundingBoxData.intersectsSegment(t,e,a,n,r,s,o);return h>0&&(1===h||2===h?r?(this.globalTransformMatrix.transformPoint(r.x,r.y,r),s&&(s.x=r.x,s.y=r.y)):s&&this.globalTransformMatrix.transformPoint(s.x,s.y,s):(r&&this.globalTransformMatrix.transformPoint(r.x,r.y,r),s&&this.globalTransformMatrix.transformPoint(s.x,s.y,s)),o&&(this.globalTransformMatrix.transformPoint(Math.cos(o.x),Math.sin(o.x),i._helpPoint,!0),o.x=Math.atan2(i._helpPoint.y,i._helpPoint.x),this.globalTransformMatrix.transformPoint(Math.cos(o.y),Math.sin(o.y),i._helpPoint,!0),o.y=Math.atan2(i._helpPoint.y,i._helpPoint.x))),h},i.prototype.invalidUpdate=function(){this._displayDirty=!0,this._transformDirty=!0},Object.defineProperty(i.prototype,"skinSlotData",{get:function(){return this._skinSlotData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"boundingBoxData",{get:function(){return this._boundingBoxData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rawDisplay",{get:function(){return this._rawDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"meshDisplay",{get:function(){return this._meshDisplay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayIndex",{get:function(){return this._displayIndex},set:function(t){this._setDisplayIndex(t)&&this._update(-1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"displayList",{get:function(){return this._displayList.concat()},set:function(e){var i=this._displayList.concat(),a=[];this._setDisplayList(e)&&this._update(-1);for(var n=0,r=i.length;n<r;++n){var s=i[n];s&&s!==this._rawDisplay&&s!==this._meshDisplay&&this._displayList.indexOf(s)<0&&a.indexOf(s)<0&&a.push(s)}for(var n=0,r=a.length;n<r;++n){var s=a[n];s instanceof t.Armature?s.dispose():this._disposeDisplay(s)}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"display",{get:function(){return this._display},set:function(t){if(this._display!==t){var e=this._displayList.length;if(this._displayIndex<0&&0===e&&(this._displayIndex=0),!(this._displayIndex<0)){var i=this.displayList;e<=this._displayIndex&&(i.length=this._displayIndex+1),i[this._displayIndex]=t,this.displayList=i}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"childArmature",{get:function(){return this._childArmature},set:function(t){this._childArmature!==t&&(this.display=t)},enumerable:!0,configurable:!0}),i.prototype.getDisplay=function(){return this._display},i.prototype.setDisplay=function(t){this.display=t},i}(t.TransformObject);t.Slot=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._bones=[],t._slots=[],t._actions=[],t._events=[],t.enableCache=!1,t}return __extends(i,e),i.toString=function(){return"[class dragonBones.Armature]"},i._onSortSlots=function(t,e){return t._zOrder>e._zOrder?1:-1},i.prototype._onClear=function(){for(var t=0,e=this._bones.length;t<e;++t)this._bones[t].returnToPool();for(var t=0,e=this._slots.length;t<e;++t)this._slots[t].returnToPool();for(var t=0,e=this._events.length;t<e;++t)this._events[t].returnToPool();this._clock&&this._clock.remove(this),this._proxy&&this._proxy._onClear(),this._replaceTextureAtlasData&&this._replaceTextureAtlasData.returnToPool(),this._animation&&this._animation.returnToPool(),this.inheritAnimation=!0,this.debugDraw=!1,this.userData=null,this._debugDraw=!1,this._delayDispose=!1,this._lockDispose=!1,this._bonesDirty=!1,this._slotsDirty=!1,this._zOrderDirty=!1,this._flipX=!1,this._flipY=!1,this._bones.length=0,this._slots.length=0,this._actions.length=0,this._events.length=0,this._armatureData=null,this._skinData=null,this._animation=null,this._proxy=null,this._display=null,this._eventManager=null,this._parent=null,this._clock=null,this._replaceTextureAtlasData=null,this._replacedTexture=null},i.prototype._sortBones=function(){var t=this._bones.length;if(!(t<=0)){var e=this._bones.concat(),i=0,a=0;for(this._bones.length=0;a<t;){var n=e[i++];i>=t&&(i=0),this._bones.indexOf(n)>=0||n.parent&&this._bones.indexOf(n.parent)<0||n.ik&&this._bones.indexOf(n.ik)<0||(n.ik&&n.ikChain>0&&n.ikChainIndex===n.ikChain?this._bones.splice(this._bones.indexOf(n.parent)+1,0,n):this._bones.push(n),a++)}}},i.prototype._sortSlots=function(){this._slots.sort(i._onSortSlots)},i.prototype._doAction=function(t){switch(t.type){case 0:this._animation.playConfig(t.animationConfig)}},i.prototype._init=function(e,i,a,n,r){this._armatureData||(this._armatureData=e,this._skinData=i,this._animation=t.BaseObject.borrowObject(t.Animation),this._proxy=a,this._display=n,this._eventManager=r,this._animation._init(this),this._animation.animations=this._armatureData.animations)},i.prototype._addBoneToBoneList=function(t){this._bones.indexOf(t)<0&&(this._bonesDirty=!0,this._bones.push(t),this._animation._timelineStateDirty=!0)},i.prototype._removeBoneFromBoneList=function(t){var e=this._bones.indexOf(t);e>=0&&(this._bones.splice(e,1),this._animation._timelineStateDirty=!0)},i.prototype._addSlotToSlotList=function(t){this._slots.indexOf(t)<0&&(this._slotsDirty=!0,this._slots.push(t),this._animation._timelineStateDirty=!0)},i.prototype._removeSlotFromSlotList=function(t){var e=this._slots.indexOf(t);e>=0&&(this._slots.splice(e,1),this._animation._timelineStateDirty=!0)},i.prototype._sortZOrder=function(t){var e=this._armatureData.sortedSlots,i=!t||t.length<1;if(this._zOrderDirty||!i){for(var a=0,n=e.length;a<n;++a){var r=i?a:t[a],s=e[r];if(s){var o=this.getSlot(s.name);o&&o._setZorder(a)}}this._slotsDirty=!0,this._zOrderDirty=!i}},i.prototype._bufferAction=function(t){this._actions.push(t)},i.prototype._bufferEvent=function(t,e){t.type=e,t.armature=this,this._events.push(t)},i.prototype.dispose=function(){this._armatureData&&(this._lockDispose?this._delayDispose=!0:this.returnToPool())},i.prototype.advanceTime=function(e){if(!this._armatureData)throw new Error("The armature has been disposed.");if(!this._armatureData.parent)throw new Error("The armature data has been disposed.");var i=this._animation._cacheFrameIndex;this._animation._advanceTime(e);var a=this._animation._cacheFrameIndex;this._bonesDirty&&(this._bonesDirty=!1,this._sortBones()),this._slotsDirty&&(this._slotsDirty=!1,this._sortSlots());var n=0,r=0;if(a<0||a!==i){for(n=0,r=this._bones.length;n<r;++n)this._bones[n]._update(a);for(n=0,r=this._slots.length;n<r;++n)this._slots[n]._update(a)}var s=this.debugDraw||t.DragonBones.debugDraw;if((s||this._debugDraw)&&(this._debugDraw=s,this._proxy._debugDraw(this._debugDraw)),!this._lockDispose){if(this._lockDispose=!0,r=this._events.length,r>0){for(n=0;n<r;++n){var o=this._events[n];this._proxy._dispatchEvent(o.type,o),o.type===t.EventObject.SOUND_EVENT&&this._eventManager._dispatchEvent(o.type,o),o.returnToPool()}this._events.length=0}if(r=this._actions.length,r>0){for(n=0;n<r;++n){var h=this._actions[n];if(h.slot){var l=this.getSlot(h.slot.name);if(l){var _=l.childArmature;_&&_._doAction(h)}}else if(h.bone)for(var u=0,m=this._slots.length;u<m;++u){var _=this._slots[u].childArmature;_&&_._doAction(h)}else this._doAction(h)}this._actions.length=0}this._lockDispose=!1}this._delayDispose&&this.returnToPool()},i.prototype.invalidUpdate=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=!1),t){var i=this.getBone(t);if(i&&(i.invalidUpdate(),e))for(var a=0,n=this._slots.length;a<n;++a){var r=this._slots[a];r.parent===i&&r.invalidUpdate()}}else{for(var a=0,n=this._bones.length;a<n;++a)this._bones[a].invalidUpdate();if(e)for(var a=0,n=this._slots.length;a<n;++a)this._slots[a].invalidUpdate()}},i.prototype.containsPoint=function(t,e){for(var i=0,a=this._slots.length;i<a;++i){var n=this._slots[i];if(n.containsPoint(t,e))return n}return null},i.prototype.intersectsSegment=function(t,e,i,a,n,r,s){void 0===n&&(n=null),void 0===r&&(r=null),void 0===s&&(s=null);for(var o=t===i,h=0,l=0,_=0,u=0,m=0,f=0,c=0,p=0,d=null,g=null,y=0,b=this._slots.length;y<b;++y){var T=this._slots[y],v=T.intersectsSegment(t,e,i,a,n,r,s);if(v>0){if(!n&&!r){d=T;break}if(n){var D=o?n.y-e:n.x-t;D<0&&(D=-D),(!d||D<h)&&(h=D,_=n.x,u=n.y,d=T,s&&(c=s.x))}if(r){var D=r.x-t;D<0&&(D=-D),(!g||D>l)&&(l=D,m=r.x,f=r.y,g=T,s&&(p=s.y))}}}return d&&n&&(n.x=_,n.y=u,s&&(s.x=c)),g&&r&&(r.x=m,r.y=f,s&&(s.y=p)),d},i.prototype.getBone=function(t){for(var e=0,i=this._bones.length;e<i;++e){var a=this._bones[e];if(a.name===t)return a}return null},i.prototype.getBoneByDisplay=function(t){var e=this.getSlotByDisplay(t);return e?e.parent:null},i.prototype.getSlot=function(t){for(var e=0,i=this._slots.length;e<i;++e){var a=this._slots[e];if(a.name===t)return a}return null},i.prototype.getSlotByDisplay=function(t){if(t)for(var e=0,i=this._slots.length;e<i;++e){var a=this._slots[e];if(a.display===t)return a}return null},i.prototype.addBone=function(e,i){if(void 0===i&&(i=null),!e)throw new Error(t.DragonBones.ARGUMENT_ERROR);e._setArmature(this),e._setParent(i?this.getBone(i):null)},i.prototype.removeBone=function(e){if(!e||e.armature!==this)throw new Error(t.DragonBones.ARGUMENT_ERROR);e._setParent(null),e._setArmature(null)},i.prototype.addSlot=function(e,i){var a=this.getBone(i);if(!a)throw new Error(t.DragonBones.ARGUMENT_ERROR);e._setArmature(this),e._setParent(a)},i.prototype.removeSlot=function(e){if(!e||e.armature!==this)throw new Error(t.DragonBones.ARGUMENT_ERROR);e._setParent(null),e._setArmature(null)},i.prototype.replaceTexture=function(t){this.replacedTexture=t},i.prototype.getBones=function(){return this._bones},i.prototype.getSlots=function(){return this._slots},Object.defineProperty(i.prototype,"name",{get:function(){return this._armatureData?this._armatureData.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"armatureData",{get:function(){return this._armatureData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animation",{get:function(){return this._animation},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"eventDispatcher",{get:function(){return this._proxy},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"display",{get:function(){return this._display},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this._parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"flipX",{get:function(){return this._flipX},set:function(t){this._flipX!==t&&(this._flipX=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"flipY",{get:function(){return this._flipY},set:function(t){this._flipY!==t&&(this._flipY=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cacheFrameRate",{get:function(){return this._armatureData.cacheFrameRate},set:function(t){if(this._armatureData.cacheFrameRate!==t){this._armatureData.cacheFrames(t);for(var e=0,i=this._slots.length;e<i;++e){var a=this._slots[e].childArmature;a&&(a.cacheFrameRate=t)}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock!==t){var e=this._clock;this._clock=t,e&&e.remove(this),this._clock&&this._clock.add(this);for(var i=0,a=this._slots.length;i<a;++i){var n=this._slots[i].childArmature;n&&(n.clock=this._clock)}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"replacedTexture",{get:function(){return this._replacedTexture},set:function(t){if(this._replacedTexture!==t){this._replaceTextureAtlasData&&(this._replaceTextureAtlasData.returnToPool(),this._replaceTextureAtlasData=null),this._replacedTexture=t;for(var e=0,i=this._slots.length;e<i;++e){var a=this._slots[e];a.invalidUpdate(),a._update(-1)}}},enumerable:!0,configurable:!0}),i.prototype.hasEventListener=function(t){return this._proxy.hasEvent(t)},i.prototype.addEventListener=function(t,e,i){this._proxy.addEvent(t,e,i)},i.prototype.removeEventListener=function(t,e,i){this._proxy.removeEvent(t,e,i)},i.prototype.enableAnimationCache=function(t){this.cacheFrameRate=t},i.prototype.getDisplay=function(){return this._display},i}(t.BaseObject);t.Armature=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._animationNames=[],t._animations={},t._animationStates=[],t}return __extends(i,e),i._sortAnimationState=function(t,e){return t.layer>e.layer?-1:1},i.toString=function(){return"[class dragonBones.Animation]"},i.prototype._onClear=function(){for(var t=0,e=this._animationStates.length;t<e;++t)this._animationStates[t].returnToPool();this._animationConfig&&this._animationConfig.returnToPool();for(var i in this._animations)delete this._animations[i];this.timeScale=1,this._isPlaying=!1,this._animationStateDirty=!1,this._timelineStateDirty=!1,this._cacheFrameIndex=-1,this._animationNames.length=0,this._animationStates.length=0,this._armature=null,this._lastAnimationState=null,this._animationConfig=null},i.prototype._fadeOut=function(t){var e=0,i=this._animationStates.length,a=null;switch(t.fadeOutMode){case 1:for(;e<i;++e)a=this._animationStates[e],a.layer===t.layer&&a.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 2:for(;e<i;++e)a=this._animationStates[e],a.group===t.group&&a.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 3:for(;e<i;++e)a=this._animationStates[e],a.layer===t.layer&&a.group===t.group&&a.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 4:for(;e<i;++e)a=this._animationStates[e],a.fadeOut(t.fadeOutTime,t.pauseFadeOut);break;case 0:}},i.prototype._init=function(e){this._armature||(this._armature=e,this._animationConfig=t.BaseObject.borrowObject(t.AnimationConfig))},i.prototype._advanceTime=function(t){if(this._isPlaying){t<0&&(t=-t),this._armature.inheritAnimation&&this._armature._parent&&(t*=this._armature._parent._armature.animation.timeScale),1!==this.timeScale&&(t*=this.timeScale);var e=this._animationStates.length;if(1===e){var i=this._animationStates[0];if(i._fadeState>0&&i._subFadeState>0)i.returnToPool(),this._animationStates.length=0,this._animationStateDirty=!0,this._lastAnimationState=null;else{var a=i.animationData,n=a.cacheFrameRate;if(this._animationStateDirty&&n>0){this._animationStateDirty=!1;for(var r=this._armature.getBones(),s=0,o=r.length;s<o;++s){var h=r[s];h._cachedFrameIndices=a.getBoneCachedFrameIndices(h.name)}for(var l=this._armature.getSlots(),s=0,o=l.length;s<o;++s){var _=l[s];_._cachedFrameIndices=a.getSlotCachedFrameIndices(_.name)}}this._timelineStateDirty&&i._updateTimelineStates(),i._advanceTime(t,n)}}else if(e>1){for(var s=0,u=0;s<e;++s){var i=this._animationStates[s];i._fadeState>0&&i._subFadeState>0?(u++,i.returnToPool(),this._animationStateDirty=!0,this._lastAnimationState===i&&(this._lastAnimationState=null)):(u>0&&(this._animationStates[s-u]=i),this._timelineStateDirty&&i._updateTimelineStates(),
i._advanceTime(t,0)),s===e-1&&u>0&&(this._animationStates.length-=u,!this._lastAnimationState&&this._animationStates.length>0&&(this._lastAnimationState=this._animationStates[this._animationStates.length-1]))}this._cacheFrameIndex=-1}else this._cacheFrameIndex=-1;this._timelineStateDirty=!1}},i.prototype.reset=function(){for(var t=0,e=this._animationStates.length;t<e;++t)this._animationStates[t].returnToPool();this._isPlaying=!1,this._animationStateDirty=!1,this._timelineStateDirty=!1,this._cacheFrameIndex=-1,this._animationConfig.clear(),this._animationStates.length=0,this._lastAnimationState=null},i.prototype.stop=function(t){if(void 0===t&&(t=null),t){var e=this.getState(t);e&&e.stop()}else this._isPlaying=!1},i.prototype.playConfig=function(e){if(!e)throw new Error(t.DragonBones.ARGUMENT_ERROR);var a=e.animationName?e.animationName:e.name,n=this._animations[a];if(!n)return console.warn("Non-existent animation.\n","DragonBones name: "+this._armature.armatureData.parent.name,"Armature name: "+this._armature.name,"Animation name: "+a),null;this._isPlaying=!0,(e.fadeInTime<0||e.fadeInTime!==e.fadeInTime)&&(this._lastAnimationState?e.fadeInTime=n.fadeInTime:e.fadeInTime=0),(e.fadeOutTime<0||e.fadeOutTime!==e.fadeOutTime)&&(e.fadeOutTime=e.fadeInTime),(e.timeScale<=-100||e.timeScale!==e.timeScale)&&(e.timeScale=1/n.scale),n.frameCount>1?(e.position!==e.position?e.position=0:e.position<0?(e.position%=n.duration,e.position=n.duration-e.position):e.position===n.duration?e.position-=1e-6:e.position>n.duration&&(e.position%=n.duration),e.duration>0&&e.position+e.duration>n.duration&&(e.duration=n.duration-e.position),e.playTimes<0&&(e.playTimes=n.playTimes)):(e.playTimes=1,e.position=0,e.duration>0&&(e.duration=0));var r=!1;0===e.duration&&(e.duration=-1,r=!0),this._fadeOut(e),this._lastAnimationState=t.BaseObject.borrowObject(t.AnimationState),this._lastAnimationState._init(this._armature,n,e),this._animationStates.push(this._lastAnimationState),this._animationStateDirty=!0,this._cacheFrameIndex=-1,this._animationStates.length>1&&this._animationStates.sort(i._sortAnimationState);for(var s=this._armature.getSlots(),o=0,h=s.length;o<h;++o){var l=s[o].childArmature;l&&l.inheritAnimation&&l.animation.hasAnimation(a)&&!l.animation.getState(a)&&l.animation.fadeIn(a)}return e.fadeInTime<=0&&this._armature.advanceTime(0),r&&this._lastAnimationState.stop(),this._lastAnimationState},i.prototype.fadeIn=function(t,e,i,a,n,r){return void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===a&&(a=0),void 0===n&&(n=null),void 0===r&&(r=3),this._animationConfig.clear(),this._animationConfig.fadeOutMode=r,this._animationConfig.playTimes=i,this._animationConfig.layer=a,this._animationConfig.fadeInTime=e,this._animationConfig.animationName=t,this._animationConfig.group=n,this.playConfig(this._animationConfig)},i.prototype.play=function(t,e){if(void 0===t&&(t=null),void 0===e&&(e=-1),this._animationConfig.clear(),this._animationConfig.playTimes=e,this._animationConfig.fadeInTime=0,this._animationConfig.animationName=t,t)this.playConfig(this._animationConfig);else if(this._lastAnimationState)this._isPlaying&&(this._lastAnimationState.isPlaying||this._lastAnimationState.isCompleted)?(this._animationConfig.animationName=this._lastAnimationState.name,this.playConfig(this._animationConfig)):(this._isPlaying=!0,this._lastAnimationState.play());else{var i=this._armature.armatureData.defaultAnimation;i&&(this._animationConfig.animationName=i.name,this.playConfig(this._animationConfig))}return this._lastAnimationState},i.prototype.gotoAndPlayByTime=function(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.playTimes=i,this._animationConfig.position=e,this._animationConfig.fadeInTime=0,this._animationConfig.animationName=t,this.playConfig(this._animationConfig)},i.prototype.gotoAndPlayByFrame=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0,this._animationConfig.animationName=t;var a=this._animations[t];return a&&(this._animationConfig.position=a.duration*e/a.frameCount),this.playConfig(this._animationConfig)},i.prototype.gotoAndPlayByProgress=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=-1),this._animationConfig.clear(),this._animationConfig.playTimes=i,this._animationConfig.fadeInTime=0,this._animationConfig.animationName=t;var a=this._animations[t];return a&&(this._animationConfig.position=a.duration*(e>0?e:0)),this.playConfig(this._animationConfig)},i.prototype.gotoAndStopByTime=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByTime(t,e,1);return i&&i.stop(),i},i.prototype.gotoAndStopByFrame=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByFrame(t,e,1);return i&&i.stop(),i},i.prototype.gotoAndStopByProgress=function(t,e){void 0===e&&(e=0);var i=this.gotoAndPlayByProgress(t,e,1);return i&&i.stop(),i},i.prototype.getState=function(t){for(var e=0,i=this._animationStates.length;e<i;++e){var a=this._animationStates[e];if(a.name===t)return a}return null},i.prototype.hasAnimation=function(t){return null!=this._animations[t]},Object.defineProperty(i.prototype,"isPlaying",{get:function(){return this._animationStates.length>1?this._isPlaying&&!this.isCompleted:this._lastAnimationState?this._isPlaying&&this._lastAnimationState.isPlaying:this._isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCompleted",{get:function(){if(this._lastAnimationState){if(!this._lastAnimationState.isCompleted)return!1;for(var t=0,e=this._animationStates.length;t<e;++t)if(!this._animationStates[t].isCompleted)return!1;return!0}return!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastAnimationName",{get:function(){return this._lastAnimationState?this._lastAnimationState.name:null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"lastAnimationState",{get:function(){return this._lastAnimationState},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationConfig",{get:function(){return this._animationConfig.clear(),this._animationConfig},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationNames",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animations",{get:function(){return this._animations},set:function(t){if(this._animations!==t){this._animationNames.length=0;for(var e in this._animations)delete this._animations[e];if(t)for(var e in t)this._animations[e]=t[e],this._animationNames.push(e)}},enumerable:!0,configurable:!0}),i.prototype.gotoAndPlay=function(t,e,i,a,n,r,s,o,h){void 0===e&&(e=-1),void 0===i&&(i=-1),void 0===a&&(a=-1),void 0===n&&(n=0),void 0===r&&(r=null),void 0===s&&(s=3),void 0===o&&(o=!0),void 0===h&&(h=!0),this._animationConfig.clear(),this._animationConfig.fadeOutMode=s,this._animationConfig.playTimes=a,this._animationConfig.layer=n,this._animationConfig.fadeInTime=e,this._animationConfig.animationName=t,this._animationConfig.group=r;var l=this._animations[t];return l&&i>0&&(this._animationConfig.timeScale=l.duration/i),this.playConfig(this._animationConfig)},i.prototype.gotoAndStop=function(t,e){return void 0===e&&(e=0),this.gotoAndStopByTime(t,e)},Object.defineProperty(i.prototype,"animationList",{get:function(){return this._animationNames},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationDataList",{get:function(){for(var t=[],e=0,i=this._animationNames.length;e<i;++e)t.push(this._animations[this._animationNames[e]]);return t},enumerable:!0,configurable:!0}),i}(t.BaseObject);e.None=0,e.SameLayer=1,e.SameGroup=2,e.SameLayerAndGroup=3,e.All=4,t.Animation=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){var t=e.call(this)||this;return t._boneMask=[],t._animationNames=[],t._boneTimelines=[],t._slotTimelines=[],t._ffdTimelines=[],t.autoTween=!1,t}return __extends(i,e),i.toString=function(){return"[class dragonBones.AnimationState]"},i.prototype._onClear=function(){for(var t=0,e=this._boneTimelines.length;t<e;++t)this._boneTimelines[t].returnToPool();for(var t=0,e=this._slotTimelines.length;t<e;++t)this._slotTimelines[t].returnToPool();for(var t=0,e=this._ffdTimelines.length;t<e;++t)this._ffdTimelines[t].returnToPool();this._timeline&&this._timeline.returnToPool(),this._zOrderTimeline&&this._zOrderTimeline.returnToPool(),this.displayControl=!0,this.additiveBlending=!1,this.actionEnabled=!1,this.playTimes=1,this.timeScale=1,this.weight=1,this.autoFadeOutTime=-1,this.fadeTotalTime=0,this._playheadState=0,this._fadeState=-1,this._subFadeState=-1,this._layer=0,this._position=0,this._duration=0,this._fadeTime=0,this._time=0,this._fadeProgress=0,this._weightResult=0,this._name=null,this._group=null,this._boneMask.length=0,this._animationNames.length=0,this._boneTimelines.length=0,this._slotTimelines.length=0,this._ffdTimelines.length=0,this._animationData=null,this._armature=null,this._timeline=null,this._zOrderTimeline=null},i.prototype._advanceFadeTime=function(e){var i=this._fadeState>0;if(this._subFadeState<0){this._subFadeState=0;var a=i?t.EventObject.FADE_OUT:t.EventObject.FADE_IN;if(this._armature.eventDispatcher.hasEvent(a)){var n=t.BaseObject.borrowObject(t.EventObject);n.animationState=this,this._armature._bufferEvent(n,a)}}if(e<0&&(e=-e),this._fadeTime+=e,this._fadeTime>=this.fadeTotalTime?(this._subFadeState=1,this._fadeProgress=i?0:1):this._fadeTime>0?this._fadeProgress=i?1-this._fadeTime/this.fadeTotalTime:this._fadeTime/this.fadeTotalTime:this._fadeProgress=i?1:0,this._subFadeState>0){i||(this._playheadState|=1,this._fadeState=0);var a=i?t.EventObject.FADE_OUT_COMPLETE:t.EventObject.FADE_IN_COMPLETE;if(this._armature.eventDispatcher.hasEvent(a)){var n=t.BaseObject.borrowObject(t.EventObject);n.animationState=this,this._armature._bufferEvent(n,a)}}},i.prototype._init=function(e,i,a){if(this._armature=e,this._animationData=i,this._name=a.name?a.name:a.animationName,this.actionEnabled=a.actionEnabled,this.additiveBlending=a.additiveBlending,this.displayControl=a.displayControl,this.playTimes=a.playTimes,this.timeScale=a.timeScale,this.fadeTotalTime=a.fadeInTime,this.autoFadeOutTime=a.autoFadeOutTime,this.weight=a.weight,a.pauseFadeIn?this._playheadState=2:this._playheadState=3,this._fadeState=-1,this._subFadeState=-1,this._layer=a.layer,this._group=a.group,a.duration<0?(this._position=0,this._duration=this._animationData.duration,0!==a.position?this.timeScale>=0?this._time=a.position:this._time=a.position-this._duration:this._time=0):(this._position=a.position,this._duration=a.duration,this._time=0),this.timeScale<0&&0===this._time&&(this._time=-1e-6),this.fadeTotalTime<=0&&(this._fadeProgress=.999999),a.boneMask.length>0){this._boneMask.length=a.boneMask.length;for(var n=0,r=this._boneMask.length;n<r;++n)this._boneMask[n]=a.boneMask[n]}if(a.animationNames.length>0){this._animationNames.length=a.animationNames.length;for(var n=0,r=this._animationNames.length;n<r;++n)this._animationNames[n]=a.animationNames[n]}this._timeline=t.BaseObject.borrowObject(t.AnimationTimelineState),this._timeline._init(this._armature,this,this._animationData),this._animationData.zOrderTimeline&&(this._zOrderTimeline=t.BaseObject.borrowObject(t.ZOrderTimelineState),this._zOrderTimeline._init(this._armature,this,this._animationData.zOrderTimeline)),this._updateTimelineStates()},i.prototype._updateTimelineStates=function(){for(var e={},i={},a={},n=0,r=this._boneTimelines.length;n<r;++n){var s=this._boneTimelines[n];e[s.bone.name]=s}for(var o=this._armature.getBones(),n=0,r=o.length;n<r;++n){var h=o[n],l=h.name;if(this.containsBoneMask(l)){var _=this._animationData.getBoneTimeline(l);if(_)if(e[l])delete e[l];else{var s=t.BaseObject.borrowObject(t.BoneTimelineState);s.bone=h,s._init(this._armature,this,_),this._boneTimelines.push(s)}}}for(var u in e){var s=e[u];s.bone.invalidUpdate(),this._boneTimelines.splice(this._boneTimelines.indexOf(s),1),s.returnToPool()}for(var n=0,r=this._slotTimelines.length;n<r;++n){var m=this._slotTimelines[n];i[m.slot.name]=m}for(var n=0,r=this._ffdTimelines.length;n<r;++n){var f=this._ffdTimelines[n],c=f._timelineData.display,p=c.inheritAnimation?c.mesh.name:c.name;a[p]=f}for(var d=this._armature.getSlots(),n=0,r=d.length;n<r;++n){var g=d[n],y=g.name,b=g.parent.name,T=!1;if(this.containsBoneMask(b)){var v=this._animationData.getSlotTimeline(y);if(v)if(i[y])delete i[y];else{var m=t.BaseObject.borrowObject(t.SlotTimelineState);m.slot=g,m._init(this._armature,this,v),this._slotTimelines.push(m)}var D=this._animationData.getFFDTimeline(this._armature._skinData.name,y);if(D)for(var u in D)if(a[u])delete a[u];else{var f=t.BaseObject.borrowObject(t.FFDTimelineState);f.slot=g,f._init(this._armature,this,D[u]),this._ffdTimelines.push(f)}else T=!0}else T=!0;if(T){for(var O=0,S=g._ffdVertices.length;O<S;++O)g._ffdVertices[O]=0;g._meshDirty=!0}}for(var u in i){var m=i[u];this._slotTimelines.splice(this._slotTimelines.indexOf(m),1),m.returnToPool()}for(var u in a){var f=a[u];this._ffdTimelines.splice(this._ffdTimelines.indexOf(f),1),f.returnToPool()}},i.prototype._advanceTime=function(t,e){if(0===this._fadeState&&0===this._subFadeState||this._advanceFadeTime(t),1!==this.timeScale&&(t*=this.timeScale),0!==t&&3===this._playheadState&&(this._time+=t),0!==this.weight){var i=0===this._fadeState&&e>0,a=!0,n=!0,r=this._time;if(this._weightResult=this.weight*this._fadeProgress,this._timeline.update(r),i){var s=2*e;this._timeline._currentTime=Math.floor(this._timeline._currentTime*s)/s}if(this._zOrderTimeline&&this._zOrderTimeline.update(r),i){var o=Math.floor(this._timeline._currentTime*e);this._armature.animation._cacheFrameIndex===o?(a=!1,n=!1):(this._armature.animation._cacheFrameIndex=o,this._animationData.cachedFrames[o]?n=!1:this._animationData.cachedFrames[o]=!0)}if(a){if(n)for(var h=0,l=this._boneTimelines.length;h<l;++h)this._boneTimelines[h].update(r);for(var h=0,l=this._slotTimelines.length;h<l;++h)this._slotTimelines[h].update(r);for(var h=0,l=this._ffdTimelines.length;h<l;++h)this._ffdTimelines[h].update(r)}}0===this._fadeState&&(this._subFadeState>0&&(this._subFadeState=0),this._timeline._playState>0&&(this.autoFadeOutTime>=0&&this.fadeOut(this.autoFadeOutTime),this._animationNames.length>0))},i.prototype._isDisabled=function(t){return!(this.displayControl&&(!t.displayController||t.displayController===this._name||t.displayController===this._group))},i.prototype.play=function(){this._playheadState=3},i.prototype.stop=function(){this._playheadState&=1},i.prototype.fadeOut=function(t,e){if(void 0===e&&(e=!0),(t<0||t!==t)&&(t=0),e&&(this._playheadState&=2),this._fadeState>0){if(t>t-this._fadeTime)return}else{this._fadeState=1,this._subFadeState=-1,(t<=0||this._fadeProgress<=0)&&(this._fadeProgress=1e-6);for(var i=0,a=this._boneTimelines.length;i<a;++i)this._boneTimelines[i].fadeOut();for(var i=0,a=this._slotTimelines.length;i<a;++i)this._slotTimelines[i].fadeOut();for(var i=0,a=this._ffdTimelines.length;i<a;++i)this._ffdTimelines[i].fadeOut()}this.displayControl=!1,this.fadeTotalTime=this._fadeProgress>1e-6?t/this._fadeProgress:0,this._fadeTime=this.fadeTotalTime*(1-this._fadeProgress)},i.prototype.containsBoneMask=function(t){return 0===this._boneMask.length||this._boneMask.indexOf(t)>=0},i.prototype.addBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._armature.getBone(t);if(i){if(this._boneMask.indexOf(t)<0&&this._boneMask.push(t),e)for(var a=this._armature.getBones(),n=0,r=a.length;n<r;++n){var s=a[n];this._boneMask.indexOf(s.name)<0&&i.contains(s)&&this._boneMask.push(s.name)}this._updateTimelineStates()}},i.prototype.removeBoneMask=function(t,e){void 0===e&&(e=!0);var i=this._boneMask.indexOf(t);if(i>=0&&this._boneMask.splice(i,1),e){var a=this._armature.getBone(t);if(a){var n=this._armature.getBones();if(this._boneMask.length>0)for(var r=0,s=n.length;r<s;++r){var o=n[r],h=this._boneMask.indexOf(o.name);h>=0&&a.contains(o)&&this._boneMask.splice(h,1)}else for(var r=0,s=n.length;r<s;++r){var o=n[r];a.contains(o)||this._boneMask.push(o.name)}}}this._updateTimelineStates()},i.prototype.removeAllBoneMask=function(){this._boneMask.length=0,this._updateTimelineStates()},Object.defineProperty(i.prototype,"layer",{get:function(){return this._layer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"group",{get:function(){return this._group},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"animationData",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isCompleted",{get:function(){return this._timeline._playState>0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPlaying",{get:function(){return 2&this._playheadState&&this._timeline._playState<=0},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentPlayTimes",{get:function(){return this._timeline._currentPlayTimes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"totalTime",{get:function(){return this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currentTime",{get:function(){return this._timeline._currentTime},set:function(t){(t<0||t!==t)&&(t=0);var e=this._timeline._currentPlayTimes-(this._timeline._playState>0?1:0);if(t=t%this._duration+e*this._duration,this._time!==t){this._time=t,this._timeline.setCurrentTime(this._time),this._zOrderTimeline&&(this._zOrderTimeline._playState=-1);for(var i=0,a=this._boneTimelines.length;i<a;++i)this._boneTimelines[i]._playState=-1;for(var i=0,a=this._slotTimelines.length;i<a;++i)this._slotTimelines[i]._playState=-1;for(var i=0,a=this._ffdTimelines.length;i<a;++i)this._ffdTimelines[i]._playState=-1}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clip",{get:function(){return this._animationData},enumerable:!0,configurable:!0}),i}(t.BaseObject);t.AnimationState=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype._onClear=function(){this._playState=-1,this._currentPlayTimes=0,this._currentTime=-1,this._timelineData=null,this._frameRate=0,this._frameCount=0,this._position=0,this._duration=0,this._animationDutation=0,this._timeScale=1,this._timeOffset=0,this._currentFrame=null,this._armature=null,this._animationState=null,this._mainTimeline=null},e.prototype._onUpdateFrame=function(){},e.prototype._onArriveAtFrame=function(){},e.prototype._setCurrentTime=function(t){var e=this._playState,i=0,a=0;if(this._mainTimeline&&1===this._frameCount)this._playState=this._mainTimeline._playState>=0?1:-1,i=1,a=this._mainTimeline._currentTime;else if(this._mainTimeline&&1===this._timeScale&&0===this._timeOffset)this._playState=this._mainTimeline._playState,i=this._mainTimeline._currentPlayTimes,a=this._mainTimeline._currentTime;else{var n=this._animationState.playTimes,r=n*this._duration;t*=this._timeScale,0!==this._timeOffset&&(t+=this._timeOffset*this._animationDutation),n>0&&(t>=r||t<=-r)?(this._playState<=0&&3===this._animationState._playheadState&&(this._playState=1),i=n,a=t<0?0:this._duration):(0!==this._playState&&3===this._animationState._playheadState&&(this._playState=0),t<0?(t=-t,i=Math.floor(t/this._duration),a=this._duration-t%this._duration):(i=Math.floor(t/this._duration),a=t%this._duration)),a+=this._position}return(this._currentPlayTimes!==i||this._currentTime!==a)&&((e<0&&this._playState!==e||this._playState<=0&&this._currentPlayTimes!==i)&&(this._currentFrame=null),this._currentPlayTimes=i,this._currentTime=a,!0)},e.prototype._init=function(t,e,i){this._armature=t,this._animationState=e,this._timelineData=i,this._mainTimeline=this._animationState._timeline,this===this._mainTimeline&&(this._mainTimeline=null),this._frameRate=this._armature.armatureData.frameRate,this._frameCount=this._timelineData.frames.length,this._position=this._animationState._position,this._duration=this._animationState._duration,this._animationDutation=this._animationState.animationData.duration,this._timeScale=this._mainTimeline?1/this._timelineData.scale:1,this._timeOffset=this._mainTimeline?this._timelineData.offset:0},e.prototype.fadeOut=function(){},e.prototype.update=function(t){if(this._playState<=0&&this._setCurrentTime(t)){var e=this._frameCount>1?Math.floor(this._currentTime*this._frameRate):0,i=this._timelineData.frames[e];this._currentFrame!==i&&(this._currentFrame=i,this._onArriveAtFrame()),this._onUpdateFrame()}},e}(t.BaseObject);t.TimelineState=e;var i=function(e){function i(){return e.call(this)||this}return __extends(i,e),i._getEasingValue=function(t,e){if(t<=0)return 0;if(t>=1)return 1;var i=1;if(e>2)return t;if(e>1)i=.5*(1-Math.cos(t*Math.PI)),e-=1;else if(e>0)i=1-Math.pow(1-t,2);else if(e>=-1)e*=-1,i=Math.pow(t,2);else{if(!(e>=-2))return t;e*=-1,i=Math.acos(1-2*t)/Math.PI,e-=1}return(i-t)*e+t},i._getEasingCurveValue=function(t,e){if(t<=0)return 0;if(t>=1)return 1;var i=e.length+1,a=Math.floor(t*i),n=0===a?0:e[a-1],r=a===i-1?1:e[a];return n+(r-n)*(t*i-a)},i.prototype._onClear=function(){e.prototype._onClear.call(this),this._tweenProgress=0,this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null},i.prototype._onArriveAtFrame=function(){this._frameCount>1&&(this._currentFrame.next!==this._timelineData.frames[0]||0===this._animationState.playTimes||this._animationState.currentPlayTimes<this._animationState.playTimes-1)?(this._tweenEasing=this._currentFrame.tweenEasing,this._curve=this._currentFrame.curve):(this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null)},i.prototype._onUpdateFrame=function(){this._tweenEasing!==t.DragonBones.NO_TWEEN?(this._tweenProgress=(this._currentTime-this._currentFrame.position)/this._currentFrame.duration,0!==this._tweenEasing&&(this._tweenProgress=i._getEasingValue(this._tweenProgress,this._tweenEasing))):this._curve?(this._tweenProgress=(this._currentTime-this._currentFrame.position)/this._currentFrame.duration,this._tweenProgress=i._getEasingCurveValue(this._tweenProgress,this._curve)):this._tweenProgress=0},i}(e);t.TweenTimelineState=i}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(e){function i(){return e.call(this)||this}return __extends(i,e),i.toString=function(){return"[class dragonBones.AnimationTimelineState]"},i.prototype._onCrossFrame=function(e){if(this._animationState.actionEnabled)for(var i=e.actions,a=0,n=i.length;a<n;++a)this._armature._bufferAction(i[a]);for(var r=this._armature.eventDispatcher,s=e.events,a=0,n=s.length;a<n;++a){var o=s[a],h=null;switch(o.type){case 10:h=t.EventObject.FRAME_EVENT;break;case 11:h=t.EventObject.SOUND_EVENT}if(r.hasEvent(h)||11===o.type){var l=t.BaseObject.borrowObject(t.EventObject);l.name=o.name,l.frame=e,l.data=o.data,l.animationState=this._animationState,o.bone&&(l.bone=this._armature.getBone(o.bone.name)),o.slot&&(l.slot=this._armature.getSlot(o.slot.name)),this._armature._bufferEvent(l,h)}}},i.prototype.update=function(e){var i=this._playState,a=this._currentPlayTimes,n=this._currentTime;if(this._playState<=0&&this._setCurrentTime(e)){var r=this._armature.eventDispatcher;if(i<0&&this._playState!==i&&(this._animationState.displayControl&&this._armature._sortZOrder(null),r.hasEvent(t.EventObject.START))){var s=t.BaseObject.borrowObject(t.EventObject);s.animationState=this._animationState,this._armature._bufferEvent(s,t.EventObject.START)}if(n<0)return;var o=!1,h=null,l=null;if(this._currentPlayTimes!==a?(r.hasEvent(t.EventObject.LOOP_COMPLETE)&&(h=t.BaseObject.borrowObject(t.EventObject),h.animationState=this._animationState),this._playState>0?(r.hasEvent(t.EventObject.COMPLETE)&&(l=t.BaseObject.borrowObject(t.EventObject),l.animationState=this._animationState),o=n>this._currentTime):o=n<this._currentTime):o=n>this._currentTime,this._frameCount>1){var _=Math.floor(this._currentTime*this._frameRate),u=this._timelineData.frames[_];if(this._currentFrame!==u){var m=this._currentFrame;if(this._currentFrame=u,o){if(!m){var f=Math.floor(n*this._frameRate);m=this._timelineData.frames[f],this._currentPlayTimes===a&&m===u&&(m=null)}for(;m&&(this._position<=m.position&&m.position<=this._position+this._duration&&this._onCrossFrame(m),h&&m===this._timelineData.frames[0]&&(this._armature._bufferEvent(h,t.EventObject.LOOP_COMPLETE),h=null),m=m.prev,m!==u););}else{if(!m){var f=Math.floor(n*this._frameRate);m=this._timelineData.frames[f],this._currentPlayTimes===a&&(n<=m.position?m=m.prev:m===u&&(m=null))}for(;m&&(m=m.next,h&&m===this._timelineData.frames[0]&&(this._armature._bufferEvent(h,t.EventObject.LOOP_COMPLETE),h=null),this._position<=m.position&&m.position<=this._position+this._duration&&this._onCrossFrame(m),m!==u););}}}else this._frameCount>0&&!this._currentFrame&&(this._currentFrame=this._timelineData.frames[0],this._currentPlayTimes===a?n<=this._currentFrame.position&&this._onCrossFrame(this._currentFrame):this._position<=this._currentFrame.position&&(!o&&h&&(this._armature._bufferEvent(h,t.EventObject.LOOP_COMPLETE),h=null),this._onCrossFrame(this._currentFrame)));h&&(this._armature._bufferEvent(h,t.EventObject.LOOP_COMPLETE),h=null),l&&(this._armature._bufferEvent(l,t.EventObject.COMPLETE),l=null)}},i.prototype.setCurrentTime=function(t){this._setCurrentTime(t),this._currentFrame=null},i}(t.TimelineState);t.AnimationTimelineState=e;var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.ZOrderTimelineState]"},e.prototype._onArriveAtFrame=function(){t.prototype._onArriveAtFrame.call(this),this._armature._sortZOrder(this._currentFrame.zOrder)},e}(t.TimelineState);t.ZOrderTimelineState=i;var a=function(e){function i(){var i=e.call(this)||this;return i._transform=new t.Transform,i._durationTransform=new t.Transform,i}return __extends(i,e),i.toString=function(){return"[class dragonBones.BoneTimelineState]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.bone=null,this._transformDirty=!1,this._tweenTransform=0,this._tweenRotate=0,this._tweenScale=0,this._transform.identity(),this._durationTransform.identity(),this._boneTransform=null,this._originalTransform=null},i.prototype._onArriveAtFrame=function(){if(e.prototype._onArriveAtFrame.call(this),this._tweenTransform=1,this._tweenRotate=1,this._tweenScale=1,this._frameCount>1&&(this._tweenEasing!==t.DragonBones.NO_TWEEN||this._curve)){var i=this._currentFrame.transform,a=this._currentFrame.next,n=a.transform;this._durationTransform.x=n.x-i.x,this._durationTransform.y=n.y-i.y,0===this._durationTransform.x&&0===this._durationTransform.y||(this._tweenTransform=2);var r=this._currentFrame.tweenRotate;r!==t.DragonBones.NO_TWEEN?(r?((r>0?n.skewY>=i.skewY:n.skewY<=i.skewY)&&(r=r>0?r-1:r+1),this._durationTransform.skewX=n.skewX-i.skewX+t.DragonBones.PI_D*r,this._durationTransform.skewY=n.skewY-i.skewY+t.DragonBones.PI_D*r):(this._durationTransform.skewX=t.Transform.normalizeRadian(n.skewX-i.skewX),this._durationTransform.skewY=t.Transform.normalizeRadian(n.skewY-i.skewY)),0===this._durationTransform.skewX&&0===this._durationTransform.skewY||(this._tweenRotate=2)):(this._durationTransform.skewX=0,this._durationTransform.skewY=0),this._currentFrame.tweenScale?(this._durationTransform.scaleX=n.scaleX-i.scaleX,this._durationTransform.scaleY=n.scaleY-i.scaleY,0===this._durationTransform.scaleX&&0===this._durationTransform.scaleY||(this._tweenScale=2)):(this._durationTransform.scaleX=0,this._durationTransform.scaleY=0)}else this._durationTransform.x=0,this._durationTransform.y=0,this._durationTransform.skewX=0,this._durationTransform.skewY=0,this._durationTransform.scaleX=0,this._durationTransform.scaleY=0},i.prototype._onUpdateFrame=function(){e.prototype._onUpdateFrame.call(this);var t=0,i=this._currentFrame.transform;0!==this._tweenTransform&&(1===this._tweenTransform?(this._tweenTransform=0,t=0):t=this._tweenProgress,this._animationState.additiveBlending?(this._transform.x=i.x+this._durationTransform.x*t,this._transform.y=i.y+this._durationTransform.y*t):(this._transform.x=this._originalTransform.x+i.x+this._durationTransform.x*t,this._transform.y=this._originalTransform.y+i.y+this._durationTransform.y*t),this._transformDirty=!0),0!==this._tweenRotate&&(1===this._tweenRotate?(this._tweenRotate=0,t=0):t=this._tweenProgress,this._animationState.additiveBlending?(this._transform.skewX=i.skewX+this._durationTransform.skewX*t,this._transform.skewY=i.skewY+this._durationTransform.skewY*t):(this._transform.skewX=this._originalTransform.skewX+i.skewX+this._durationTransform.skewX*t,this._transform.skewY=this._originalTransform.skewY+i.skewY+this._durationTransform.skewY*t),this._transformDirty=!0),0!==this._tweenScale&&(1===this._tweenScale?(this._tweenScale=0,t=0):t=this._tweenProgress,this._animationState.additiveBlending?(this._transform.scaleX=i.scaleX+this._durationTransform.scaleX*t,this._transform.scaleY=i.scaleY+this._durationTransform.scaleY*t):(this._transform.scaleX=this._originalTransform.scaleX*(i.scaleX+this._durationTransform.scaleX*t),this._transform.scaleY=this._originalTransform.scaleY*(i.scaleY+this._durationTransform.scaleY*t)),this._transformDirty=!0)},i.prototype._init=function(t,i,a){e.prototype._init.call(this,t,i,a),this._originalTransform=this._timelineData.originalTransform,this._boneTransform=this.bone._animationPose},i.prototype.fadeOut=function(){this._transform.skewX=t.Transform.normalizeRadian(this._transform.skewX),this._transform.skewY=t.Transform.normalizeRadian(this._transform.skewY)},i.prototype.update=function(t){var i=this._animationState._layer,a=this._animationState._weightResult;this.bone._blendDirty?this.bone._blendLeftWeight>0&&(this.bone._blendLayer!==i&&(this.bone._blendTotalWeight>=this.bone._blendLeftWeight?this.bone._blendLeftWeight=0:(this.bone._blendLayer=i,this.bone._blendLeftWeight-=this.bone._blendTotalWeight,this.bone._blendTotalWeight=0)),a*=this.bone._blendLeftWeight,a>=0&&(e.prototype.update.call(this,t),this.bone._blendTotalWeight+=a,this._boneTransform.x+=this._transform.x*a,this._boneTransform.y+=this._transform.y*a,this._boneTransform.skewX+=this._transform.skewX*a,this._boneTransform.skewY+=this._transform.skewY*a,this._boneTransform.scaleX+=(this._transform.scaleX-1)*a,this._boneTransform.scaleY+=(this._transform.scaleY-1)*a)):(e.prototype.update.call(this,t),this.bone._blendLayer=i,this.bone._blendLeftWeight=1,this.bone._blendTotalWeight=a,this._boneTransform.x=this._transform.x*a,this._boneTransform.y=this._transform.y*a,this._boneTransform.skewX=this._transform.skewX*a,this._boneTransform.skewY=this._transform.skewY*a,this._boneTransform.scaleX=(this._transform.scaleX-1)*a+1,this._boneTransform.scaleY=(this._transform.scaleY-1)*a+1,this.bone._blendDirty=!0),(this._transformDirty||0!==this._animationState._fadeState||0!==this._animationState._subFadeState)&&(this._transformDirty=!1,this.bone.invalidUpdate())},i}(t.TweenTimelineState);t.BoneTimelineState=a;var n=function(e){function i(){var i=e.call(this)||this;return i._color=new t.ColorTransform,i._durationColor=new t.ColorTransform,i}return __extends(i,e),i.toString=function(){return"[class dragonBones.SlotTimelineState]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this._colorDirty=!1,this._tweenColor=0,this._color.identity(),this._durationColor.identity(),this._slotColor=null},i.prototype._onArriveAtFrame=function(){if(e.prototype._onArriveAtFrame.call(this),this._animationState._isDisabled(this.slot))return this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null,void(this._tweenColor=0);var i=this._currentFrame.displayIndex;if(this._playState>=0&&this.slot.displayIndex!==i&&this.slot._setDisplayIndex(i),i>=0){this._tweenColor=0;var a=this._currentFrame.color;if(this._tweenEasing!==t.DragonBones.NO_TWEEN||this._curve){var n=this._currentFrame.next,r=n.color;a!==r&&(this._durationColor.alphaMultiplier=r.alphaMultiplier-a.alphaMultiplier,
this._durationColor.redMultiplier=r.redMultiplier-a.redMultiplier,this._durationColor.greenMultiplier=r.greenMultiplier-a.greenMultiplier,this._durationColor.blueMultiplier=r.blueMultiplier-a.blueMultiplier,this._durationColor.alphaOffset=r.alphaOffset-a.alphaOffset,this._durationColor.redOffset=r.redOffset-a.redOffset,this._durationColor.greenOffset=r.greenOffset-a.greenOffset,this._durationColor.blueOffset=r.blueOffset-a.blueOffset,0===this._durationColor.alphaMultiplier&&0===this._durationColor.redMultiplier&&0===this._durationColor.greenMultiplier&&0===this._durationColor.blueMultiplier&&0===this._durationColor.alphaOffset&&0===this._durationColor.redOffset&&0===this._durationColor.greenOffset&&0===this._durationColor.blueOffset||(this._tweenColor=2))}0===this._tweenColor&&(this._slotColor.alphaMultiplier===a.alphaMultiplier&&this._slotColor.redMultiplier===a.redMultiplier&&this._slotColor.greenMultiplier===a.greenMultiplier&&this._slotColor.blueMultiplier===a.blueMultiplier&&this._slotColor.alphaOffset===a.alphaOffset&&this._slotColor.redOffset===a.redOffset&&this._slotColor.greenOffset===a.greenOffset&&this._slotColor.blueOffset===a.blueOffset||(this._tweenColor=1))}else this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null,this._tweenColor=0},i.prototype._onUpdateFrame=function(){e.prototype._onUpdateFrame.call(this);var t=0;if(0!==this._tweenColor&&this.slot.parent._blendLayer>=this._animationState._layer){1===this._tweenColor?(this._tweenColor=0,t=0):t=this._tweenProgress;var i=this._currentFrame.color;this._color.alphaMultiplier=i.alphaMultiplier+this._durationColor.alphaMultiplier*t,this._color.redMultiplier=i.redMultiplier+this._durationColor.redMultiplier*t,this._color.greenMultiplier=i.greenMultiplier+this._durationColor.greenMultiplier*t,this._color.blueMultiplier=i.blueMultiplier+this._durationColor.blueMultiplier*t,this._color.alphaOffset=i.alphaOffset+this._durationColor.alphaOffset*t,this._color.redOffset=i.redOffset+this._durationColor.redOffset*t,this._color.greenOffset=i.greenOffset+this._durationColor.greenOffset*t,this._color.blueOffset=i.blueOffset+this._durationColor.blueOffset*t,this._colorDirty=!0}},i.prototype._init=function(t,i,a){e.prototype._init.call(this,t,i,a),this._slotColor=this.slot._colorTransform},i.prototype.fadeOut=function(){this._tweenColor=0},i.prototype.update=function(t){if(e.prototype.update.call(this,t),0!==this._tweenColor||this._colorDirty)if(0!==this._animationState._fadeState||0!==this._animationState._subFadeState){var i=Math.pow(this._animationState._fadeProgress,4);this._slotColor.alphaMultiplier+=(this._color.alphaMultiplier-this._slotColor.alphaMultiplier)*i,this._slotColor.redMultiplier+=(this._color.redMultiplier-this._slotColor.redMultiplier)*i,this._slotColor.greenMultiplier+=(this._color.greenMultiplier-this._slotColor.greenMultiplier)*i,this._slotColor.blueMultiplier+=(this._color.blueMultiplier-this._slotColor.blueMultiplier)*i,this._slotColor.alphaOffset+=(this._color.alphaOffset-this._slotColor.alphaOffset)*i,this._slotColor.redOffset+=(this._color.redOffset-this._slotColor.redOffset)*i,this._slotColor.greenOffset+=(this._color.greenOffset-this._slotColor.greenOffset)*i,this._slotColor.blueOffset+=(this._color.blueOffset-this._slotColor.blueOffset)*i,this.slot._colorDirty=!0}else this._colorDirty&&(this._colorDirty=!1,this._slotColor.alphaMultiplier=this._color.alphaMultiplier,this._slotColor.redMultiplier=this._color.redMultiplier,this._slotColor.greenMultiplier=this._color.greenMultiplier,this._slotColor.blueMultiplier=this._color.blueMultiplier,this._slotColor.alphaOffset=this._color.alphaOffset,this._slotColor.redOffset=this._color.redOffset,this._slotColor.greenOffset=this._color.greenOffset,this._slotColor.blueOffset=this._color.blueOffset,this.slot._colorDirty=!0)},i}(t.TweenTimelineState);t.SlotTimelineState=n;var r=function(e){function i(){var t=e.call(this)||this;return t._ffdVertices=[],t._durationFFDVertices=[],t}return __extends(i,e),i.toString=function(){return"[class dragonBones.FFDTimelineState]"},i.prototype._onClear=function(){e.prototype._onClear.call(this),this.slot=null,this._ffdDirty=!1,this._tweenFFD=0,this._ffdVertices.length=0,this._durationFFDVertices.length=0,this._slotFFDVertices=null},i.prototype._onArriveAtFrame=function(){if(e.prototype._onArriveAtFrame.call(this),this.slot.displayIndex>=0&&this._animationState._isDisabled(this.slot))return this._tweenEasing=t.DragonBones.NO_TWEEN,this._curve=null,void(this._tweenFFD=0);if(this._tweenFFD=0,this._tweenEasing!==t.DragonBones.NO_TWEEN||this._curve)for(var i=this._currentFrame.tweens,a=this._currentFrame.next.tweens,n=0,r=i.length;n<r;++n){var s=a[n]-i[n];this._durationFFDVertices[n]=s,0!==s&&(this._tweenFFD=2)}if(0===this._tweenFFD){this._tweenFFD=1;for(var n=0,r=this._durationFFDVertices.length;n<r;++n)this._durationFFDVertices[n]=0}},i.prototype._onUpdateFrame=function(){e.prototype._onUpdateFrame.call(this);var t=0;if(0!==this._tweenFFD&&this.slot.parent._blendLayer>=this._animationState._layer){1===this._tweenFFD?(this._tweenFFD=0,t=0):t=this._tweenProgress;for(var i=this._currentFrame.tweens,a=0,n=i.length;a<n;++a)this._ffdVertices[a]=i[a]+this._durationFFDVertices[a]*t;this._ffdDirty=!0}},i.prototype._init=function(t,i,a){e.prototype._init.call(this,t,i,a),this._slotFFDVertices=this.slot._ffdVertices,this._ffdVertices.length=this._timelineData.frames[0].tweens.length,this._durationFFDVertices.length=this._ffdVertices.length;for(var n=0,r=this._ffdVertices.length;n<r;++n)this._ffdVertices[n]=0;for(var n=0,r=this._durationFFDVertices.length;n<r;++n)this._durationFFDVertices[n]=0},i.prototype.fadeOut=function(){this._tweenFFD=0},i.prototype.update=function(t){if(e.prototype.update.call(this,t),this.slot._meshData===this._timelineData.display.mesh&&(0!==this._tweenFFD||this._ffdDirty))if(0!==this._animationState._fadeState||0!==this._animationState._subFadeState){for(var i=Math.pow(this._animationState._fadeProgress,4),a=0,n=this._ffdVertices.length;a<n;++a)this._slotFFDVertices[a]+=(this._ffdVertices[a]-this._slotFFDVertices[a])*i;this.slot._meshDirty=!0}else if(this._ffdDirty){this._ffdDirty=!1;for(var a=0,n=this._ffdVertices.length;a<n;++a)this._slotFFDVertices[a]=this._ffdVertices[a];this.slot._meshDirty=!0}},i}(t.TweenTimelineState);t.FFDTimelineState=r}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(){this.time=(new Date).getTime()/t.DragonBones.SECOND_TO_MILLISECOND,this.timeScale=1,this._animatebles=[],this._clock=null}return Object.defineProperty(e,"clock",{get:function(){return e._clock||(e._clock=new e),e._clock},enumerable:!0,configurable:!0}),e.prototype.advanceTime=function(e){if(e!==e&&(e=0),e<0&&(e=(new Date).getTime()/t.DragonBones.SECOND_TO_MILLISECOND-this.time),1!==this.timeScale&&(e*=this.timeScale),e<0?this.time-=e:this.time+=e,e){for(var i=0,a=0,n=this._animatebles.length;i<n;++i){var r=this._animatebles[i];r?(a>0&&(this._animatebles[i-a]=r,this._animatebles[i]=null),r.advanceTime(e)):a++}if(a>0){for(n=this._animatebles.length;i<n;++i){var r=this._animatebles[i];r?this._animatebles[i-a]=r:a++}this._animatebles.length-=a}}},e.prototype.contains=function(t){return this._animatebles.indexOf(t)>=0},e.prototype.add=function(e){e&&this._animatebles.indexOf(e)<0&&(this._animatebles.push(e),e.clock=this,t.DragonBones.debug&&e instanceof t.Armature&&t.DragonBones.addArmature(e))},e.prototype.remove=function(e){var i=this._animatebles.indexOf(e);i>=0&&(this._animatebles[i]=null,e.clock=null,t.DragonBones.debug&&e instanceof t.Armature&&t.DragonBones.removeArmature(e))},e.prototype.clear=function(){for(var t=0,e=this._animatebles.length;t<e;++t){var i=this._animatebles[t];this._animatebles[t]=null,null!=i&&(i.clock=null)}},Object.defineProperty(e.prototype,"clock",{get:function(){return this._clock},set:function(t){if(this._clock!==t){var e=this._clock;this._clock=t,e&&e.remove(this),this._clock&&this._clock.add(this)}},enumerable:!0,configurable:!0}),e}();e._clock=null,t.WorldClock=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.toString=function(){return"[class dragonBones.EventObject]"},e.prototype._onClear=function(){this.type=null,this.name=null,this.frame=null,this.data=null,this.armature=null,this.bone=null,this.slot=null,this.animationState=null},e}(t.BaseObject);e.START="start",e.LOOP_COMPLETE="loopComplete",e.COMPLETE="complete",e.FADE_IN="fadeIn",e.FADE_IN_COMPLETE="fadeInComplete",e.FADE_OUT="fadeOut",e.FADE_OUT_COMPLETE="fadeOutComplete",e.FRAME_EVENT="frameEvent",e.SOUND_EVENT="soundEvent",t.EventObject=e}(dragonBones||(dragonBones={}));var dragonBones;!function(t){var e=function(){function e(i){void 0===i&&(i=null),this.autoSearch=!1,this._dragonBonesDataMap={},this._textureAtlasDataMap={},this._dataParser=null,this._dataParser=i,this._dataParser||(e._defaultParser||(e._defaultParser=new t.ObjectDataParser),this._dataParser=e._defaultParser)}return e.prototype._getTextureData=function(t,e){var i=this._textureAtlasDataMap[t];if(i)for(var a=0,n=i.length;a<n;++a){var r=i[a].getTexture(e);if(r)return r}if(this.autoSearch)for(var s in this._textureAtlasDataMap){i=this._textureAtlasDataMap[s];for(var a=0,n=i.length;a<n;++a){var o=i[a];if(o.autoSearch){var r=o.getTexture(e);if(r)return r}}}return null},e.prototype._fillBuildArmaturePackage=function(t,e,i,a,n){var r=null,s=null;if(e&&(r=this._dragonBonesDataMap[e],r&&(s=r.getArmature(i))),!s&&(!e||this.autoSearch))for(var o in this._dragonBonesDataMap)if(r=this._dragonBonesDataMap[o],(!e||r.autoSearch)&&(s=r.getArmature(i))){e=o;break}return!!s&&(t.dataName=e,t.textureAtlasName=n,t.data=r,t.armature=s,t.skin=s.getSkin(a),t.skin||(t.skin=s.defaultSkin),!0)},e.prototype._buildBones=function(e,i){for(var a=e.armature.sortedBones,n=0,r=a.length;n<r;++n){var s=a[n],o=t.BaseObject.borrowObject(t.Bone);o._init(s),s.parent?i.addBone(o,s.parent.name):i.addBone(o),s.ik&&(o.ikBendPositive=s.bendPositive,o.ikWeight=s.weight,o._setIK(i.getBone(s.ik.name),s.chain,s.chainIndex))}},e.prototype._buildSlots=function(t,e){var i=t.skin,a=t.armature.defaultSkin,n={};for(var r in a.slots){var s=a.slots[r];n[s.slot.name]=s}if(i!==a)for(var r in i.slots){var s=i.slots[r];n[s.slot.name]=s}for(var o=t.armature.sortedSlots,h=0,l=o.length;h<l;++h){var _=o[h],s=n[_.name];if(s){var u=this._generateSlot(t,s,e);u&&(e.addSlot(u,_.parent.name),u._setDisplayIndex(_.displayIndex))}}},e.prototype._replaceSlotDisplay=function(t,e,i,a){if(a<0&&(a=i.displayIndex),a>=0){var n=i.displayList;if(n.length<=a&&(n.length=a+1),i._replacedDisplayDatas.length<=a&&(i._replacedDisplayDatas.length=a+1),i._replacedDisplayDatas[a]=e,1===e.type){var r=this.buildArmature(e.path,t.dataName,null,t.textureAtlasName);n[a]=r}else{e.texture&&!t.textureAtlasName||(e.texture=this._getTextureData(t.textureAtlasName?t.textureAtlasName:t.dataName,e.path));var s=i.skinSlotData.displays;e.mesh||a<s.length&&s[a].mesh?n[a]=i.meshDisplay:n[a]=i.rawDisplay}i.displayList=n}},e.prototype.parseDragonBonesData=function(t,e,i){void 0===e&&(e=null),void 0===i&&(i=1);var a=this._dataParser.parseDragonBonesData(t,i);return this.addDragonBonesData(a,e),a},e.prototype.parseTextureAtlasData=function(t,e,i,a){void 0===i&&(i=null),void 0===a&&(a=0);var n=this._generateTextureAtlasData(null,null);return this._dataParser.parseTextureAtlasData(t,n,a),this._generateTextureAtlasData(n,e),this.addTextureAtlasData(n,i),n},e.prototype.getDragonBonesData=function(t){return this._dragonBonesDataMap[t]},e.prototype.addDragonBonesData=function(e,i){if(void 0===i&&(i=null),!e)throw new Error(t.DragonBones.ARGUMENT_ERROR);i=i||e.name,i?this._dragonBonesDataMap[i]?console.warn("Same name data.",i):this._dragonBonesDataMap[i]=e:console.warn("Unnamed data.")},e.prototype.removeDragonBonesData=function(t,e){void 0===e&&(e=!0);var i=this._dragonBonesDataMap[t];i&&(e&&i.returnToPool(),delete this._dragonBonesDataMap[t])},e.prototype.getTextureAtlasData=function(t){return this._textureAtlasDataMap[t]},e.prototype.addTextureAtlasData=function(e,i){if(void 0===i&&(i=null),!e)throw new Error(t.DragonBones.ARGUMENT_ERROR);if(i=i||e.name){var a=this._textureAtlasDataMap[i]?this._textureAtlasDataMap[i]:this._textureAtlasDataMap[i]=[];a.indexOf(e)<0&&a.push(e)}else console.warn("Unnamed data.")},e.prototype.removeTextureAtlasData=function(t,e){void 0===e&&(e=!0);var i=this._textureAtlasDataMap[t];if(i){if(e)for(var a=0,n=i.length;a<n;++a)i[a].returnToPool();delete this._textureAtlasDataMap[t]}},e.prototype.clear=function(t){void 0===t&&(t=!0);for(var e in this._dragonBonesDataMap)t&&this._dragonBonesDataMap[e].returnToPool(),delete this._dragonBonesDataMap[e];for(var e in this._textureAtlasDataMap){if(t)for(var i=this._textureAtlasDataMap[e],a=0,n=i.length;a<n;++a)i[a].returnToPool();delete this._textureAtlasDataMap[e]}},e.prototype.buildArmature=function(t,e,i,a){void 0===e&&(e=null),void 0===i&&(i=null),void 0===a&&(a=null);var n={};if(this._fillBuildArmaturePackage(n,e,t,i,a)){var r=this._generateArmature(n);return this._buildBones(n,r),this._buildSlots(n,r),r.invalidUpdate(null,!0),r.advanceTime(0),r}return console.warn("No armature data.",t,e?e:""),null},e.prototype.copyAnimationsToArmature=function(e,i,a,n,r){void 0===a&&(a=null),void 0===n&&(n=null),void 0===r&&(r=!0);var s={};if(this._fillBuildArmaturePackage(s,n,i,a,null)){var o=s.armature;if(r)e.animation.animations=o.animations;else{var h={};for(var l in e.animation.animations)h[l]=e.animation.animations[l];for(var l in o.animations)h[l]=o.animations[l];e.animation.animations=h}if(s.skin){for(var _=e.getSlots(),u=0,m=_.length;u<m;++u)for(var f=_[u],c=f.displayList,p=0,d=c.length;p<d;++p){var g=c[p];if(g instanceof t.Armature){var y=s.skin.getSlot(f.name).displays;if(p<y.length){var b=y[p];1===b.type&&this.copyAnimationsToArmature(g,b.path,a,n,r)}}}return!0}}return!1},e.prototype.replaceSlotDisplay=function(t,e,i,a,n,r){void 0===r&&(r=-1);var s={};if(this._fillBuildArmaturePackage(s,t,e,null,null)){var o=s.skin.getSlot(i);if(o)for(var h=0,l=o.displays.length;h<l;++h){var _=o.displays[h];if(_.name===a){this._replaceSlotDisplay(s,_,n,r);break}}}},e.prototype.replaceSlotDisplayList=function(t,e,i,a){var n={};if(this._fillBuildArmaturePackage(n,t,e,null,null)){var r=n.skin.getSlot(i);if(r)for(var s=0,o=r.displays.length;s<o;++s){var h=r.displays[s];this._replaceSlotDisplay(n,h,a,s)}}},e.prototype.getAllDragonBonesData=function(){return this._dragonBonesDataMap},e.prototype.getAllTextureAtlasData=function(){return this._textureAtlasDataMap},e}();e._defaultParser=null,t.BaseFactory=e}(dragonBones||(dragonBones={}));